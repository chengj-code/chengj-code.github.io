<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="chengj-code">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="http://example.com/2023/05/13/vue3学习/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
    
    
        
        <meta name="description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue3学习">
<meta property="og:url" content="http://example.com/2023/05/13/Vue3%E5%AD%A6%E4%B9%A0/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Hexo Theme Redefine, Redefine Your Hexo Journey.">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/redefine-og.webp">
<meta property="article:published_time" content="2023-05-13T07:30:42.000Z">
<meta property="article:modified_time" content="2023-06-02T02:59:08.000Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/redefine-og.webp">
    
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="/images/chengj-favicon.ico" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="/images/chengj-favicon.ico">
    <meta name="theme-color" content="#A31F34">
    <link rel="shortcut icon" href="/images/chengj-favicon.ico">
    <!--- Page Info-->
    
    <title>
        
            Vue3学习 | chengj-code的博客
        
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/css/build/tailwind.css">

    

    
<link rel="stylesheet" href="/fonts/GeistMono/geist-mono.css">

    
<link rel="stylesheet" href="/fonts/Geist/geist.css">

    <!--- Font Part-->
    
    
    
    
    
    

    <script id="hexo-configurations">
    window.config = {"hostname":"example.com","root":"/","language":"en"};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"delete_mask":false,"title_alignment":"left","headings_top_spacing":{"h1":"3.2rem","h2":"2.4rem","h3":"1.9rem","h4":"1.6rem","h5":"1.4rem","h6":"1.3rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":true,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","highlight_theme":{"light":"github","dark":"vs2015"},"font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":true,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"pangu_js":false,"recommendation":{"enable":false,"title":"推荐阅读","limit":3,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A31F34","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null},"title":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":false},"scroll_progress":{"bar":false,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":{"enable":false,"custom_message":null},"open_graph":{"enable":true,"image":"/images/redefine-og.webp","description":"Hexo Theme Redefine, Redefine Your Hexo Journey."},"google_analytics":{"enable":false,"id":null}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"/images/thumbnail01.jpg","dark":"/images/thumbnail02.jpg"},"title":"认准的路，别问多远，坚持走下去","subtitle":{"text":[],"hitokoto":{"enable":false,"show_author":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":true,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":false,"style":"default","links":{"github":null,"instagram":null,"zhihu":null,"twitter":null,"email":null},"qrs":{"weixin":null}}},"plugins":{"feed":{"enable":false},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null,"lrc":null}]},"mermaid":{"enable":false,"version":"11.4.1"}},"version":"2.8.2","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"}},"search":{"enable":false,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":null,"show_on_mobile":true,"links":null},"article_date_format":"auto","excerpt_length":200,"categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":3}},"footerStart":"2022/8/17 11:45:14"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 6.3.0"></head>



<body>
	<div class="progress-bar-container">
	

	
	<span class="pjax-progress-bar"></span>
	<!--        <span class="swup-progress-icon">-->
	<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
	<!--        </span>-->
	
</div>

<main class="page-container" id="swup">

	

	<div class="main-content-container flex flex-col justify-between min-h-dvh">
		<div class="main-content-header">
			<header class="navbar-container px-6 md:px-12">
    <div class="navbar-content transition-navbar ">
        <div class="left">
            
            <a class="logo-title" href="/">
                
                chengj-code的博客
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    HOME
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    ARCHIVES
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-dvh w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                HOME
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                ARCHIVES
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">1</div>
        <div class="label text-third-text-color text-sm">Tags</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">0</div>
        <div class="label text-third-text-color text-sm">Categories</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">6</div>
        <div class="label text-third-text-color text-sm">Posts</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


		</div>

		<div class="main-content-body transition-fade-up">
			

			<div class="main-content">
				<div class="post-page-container flex relative justify-between box-border w-full h-full">
	<div class="article-content-container">

		<div class="article-title relative w-full">
			
			<div class="w-full flex items-center pt-6 justify-start">
				<h1 class="article-title-regular text-second-text-color tracking-tight text-4xl md:text-6xl font-semibold px-2 sm:px-6 md:px-8 py-3">Vue3学习</h1>
			</div>
			
		</div>

		
		<div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
			<div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
				<img src="/images/chengj-avatar.jpeg">
			</div>
			<div class="info flex flex-col justify-between">
				<div class="author flex items-center">
					<span class="name text-default-text-color text-lg font-semibold">chengj-code</span>
					
					<span class="author-label ml-1.5 text-xs px-2 py-0.5 rounded-small text-third-text-color border border-shadow-color-1">Lv1</span>
					
				</div>
				<div class="meta-info">
					<div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2023-05-13 15:30:42</span>
        <span class="mobile">2023-05-13 15:30:42</span>
        <span class="hover-info">Created</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2023-06-02 10:59:08</span>
            <span class="mobile">2023-06-02 10:59:08</span>
            <span class="hover-info">Updated</span>
        </span>
    

    
    

    
    
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

				</div>
			</div>
		</div>
		

		


		<div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
			<h2 id="项目安装启动"><a href="#项目安装启动" class="headerlink" title="项目安装启动"></a>项目安装启动</h2><h3 id="通过命令配置淘宝镜像"><a href="#通过命令配置淘宝镜像" class="headerlink" title="通过命令配置淘宝镜像"></a>通过命令配置淘宝镜像</h3><p>切换为淘宝镜像命令（安装一些package容易报错）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">npm config set registry https://registry.npm.taobao.org<br></code></pre></td></tr></table></figure>

<p>查看当前使用的镜像地址命令</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">npm config get registry<br></code></pre></td></tr></table></figure>

<p>如果返回 <code>https://registry.npm.taobao.org</code>，说明镜像配置成功。</p>
<h3 id="切换回原镜像"><a href="#切换回原镜像" class="headerlink" title="切换回原镜像"></a>切换回原镜像</h3><p>安装一些package不容易报错</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs html">npm config set registry https://registry.npmjs.org<br>npm config set registry https://registry.npmjs.org<br></code></pre></td></tr></table></figure>

<h3 id="Vue3项目创建"><a href="#Vue3项目创建" class="headerlink" title="Vue3项目创建"></a>Vue3项目创建</h3><p>使用Vue3专用脚手架create-vue创建项目</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs html">npm init vue@latest<br>//<br>yarn create vue<br></code></pre></td></tr></table></figure>

<p>安装依赖</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">npm i<br></code></pre></td></tr></table></figure>

<p>启动项目</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">npm run dev<br></code></pre></td></tr></table></figure>

<h2 id="组合式API"><a href="#组合式API" class="headerlink" title="组合式API"></a>组合式API</h2><h3 id="setup选项"><a href="#setup选项" class="headerlink" title="setup选项"></a>setup选项</h3><p>setup选项执行时机是在beforeCreate钩子之前，自动执行</p>
<p>需要在setup()方法中定义数据和函数，然后以对象的形式return</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script&gt;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> &#123;<br>  <span class="hljs-title function_">setup</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;setup&#x27;</span>,<span class="hljs-variable language_">this</span>);<br>    <span class="hljs-keyword">const</span> message = <span class="hljs-string">&#x27;Hello world&#x27;</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">logMessage</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123;<br>      message,<br>      logMessage<br>    &#125;<br>  &#125;,<br>  <span class="hljs-title function_">beforeCreate</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;beforeCreate&#x27;</span>);<br>   &#125;<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h3 id="组合式API-1"><a href="#组合式API-1" class="headerlink" title="组合式API"></a>组合式API</h3><p>setup选项的语法糖，可以更简单使用组合式API</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;setup&#x27;</span>, <span class="hljs-variable language_">this</span>);<br><span class="hljs-keyword">const</span> message = <span class="hljs-string">&#x27;Hello world&#x27;</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">logMessage</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(message);<br>&#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>并且setup中的this不指向组件实例，指向undefined</p>
<h3 id="reactive和ref函数"><a href="#reactive和ref函数" class="headerlink" title="reactive和ref函数"></a>reactive和ref函数</h3><p>reactive() 作用：接收对象类型数据的参数传入，并返回一个响应式的对象</p>
<p>ref() 作用：接收简单类型或对象类型数据的参数传入，并返回一个响应式的对象</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-comment">// 1.导入函数</span><br><span class="hljs-comment">// import &#123; reactive &#125; from &#x27;vue&#x27;;</span><br><span class="hljs-comment">// 2.执行函数，传入一个对象类型的参数，变量接收</span><br><span class="hljs-comment">// const state = reactive(&#123; count: 0 &#125;)</span><br><span class="hljs-comment">// const setCount = () =&gt; &#123;</span><br><span class="hljs-comment">//   state.count++</span><br><span class="hljs-comment">//  &#125;</span><br><span class="hljs-comment">// 1.导入函数</span><br><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-comment">// 2.执行函数，传入一个对象类型的参数，变量接收</span><br><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-comment">// 脚本区域修改ref产生的响应式对象数据 必须通过.value属性</span><br>  state.<span class="hljs-property">value</span>++<br> &#125;<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<p>reactive和ref对比</p>
<ol>
<li>reactive不能处理简单类型的数据</li>
<li>ref参数支持更好但是必须通过.value访问修改</li>
<li>ref函数的内部实现依赖于reactive函数</li>
</ol>
<h3 id="计算属性computed"><a href="#计算属性computed" class="headerlink" title="计算属性computed"></a>计算属性computed</h3><p>计算属性不应该有副作用：即除计算数据以外的其他操作，如异步请求&#x2F;修改dom</p>
<p>避免直接修改计算属性的值，计算属性是只读的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; ref,computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">const</span> list=<span class="hljs-title function_">ref</span>([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>])<br><span class="hljs-keyword">const</span> computedList = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123; <br>  <span class="hljs-keyword">return</span> list.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span>=&gt;</span>item&gt;<span class="hljs-number">2</span>)<br>&#125;)<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  list.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>(<span class="hljs-number">9</span>,<span class="hljs-number">10</span>)<br> &#125;,<span class="hljs-number">3000</span>)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h3 id="wacth函数"><a href="#wacth函数" class="headerlink" title="wacth函数"></a>wacth函数</h3><p>作用：侦听一个或多个数据的变化，数据变化时执行回调函数</p>
<p>额外参数：</p>
<ol>
<li>immediate立即执行：在侦听器创建时立刻出发回调</li>
<li>deep深度侦听：watch侦听ref对象默认是浅层侦听的，直接修改嵌套的对象属性不会触发回调执行</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// 监听单个变量</span><br>&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; ref, watch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  count.<span class="hljs-property">value</span>++<br>&#125;<br><span class="hljs-title function_">watch</span>(count, <span class="hljs-function">() =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;count变化了&#x27;</span>);<br>&#125;, &#123;<br>  <span class="hljs-attr">immediate</span>: <span class="hljs-literal">true</span><br>&#125;)<br>&lt;/script&gt;<br><br><br><span class="hljs-comment">// 监听多个个变量</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; ref, watch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> name = <span class="hljs-title function_">ref</span>(<span class="hljs-string">&#x27;cj&#x27;</span>)</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  count.<span class="hljs-property">value</span>++</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setName</span> = (<span class="hljs-params"></span>) =&gt; &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  name.<span class="hljs-property">value</span> = name.<span class="hljs-property">value</span> + <span class="hljs-string">&#x27;cjzm&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">watch</span>([count,name], <span class="hljs-function">(<span class="hljs-params">[newCount, newName],[oldCount, oldName]</span>) =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(newCount, oldCount);</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(newName, oldName);</span></span><br><span class="language-javascript"><span class="language-xml">&#125;)</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br><br><br><span class="hljs-comment">// 监听对象中属性的变化</span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">import</span> &#123; ref, watch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span></span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">ref</span>(&#123;<span class="hljs-attr">count</span>:<span class="hljs-number">0</span>&#125;)</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  state.<span class="hljs-property">value</span>.<span class="hljs-property">count</span>++</span></span><br><span class="language-javascript"><span class="language-xml">&#125;</span></span><br><span class="language-javascript"><span class="language-xml"><span class="hljs-title function_">watch</span>(state, <span class="hljs-function">() =&gt;</span> &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;count变化了&#x27;</span>);</span></span><br><span class="language-javascript"><span class="language-xml">&#125;, &#123;</span></span><br><span class="language-javascript"><span class="language-xml">  <span class="hljs-attr">deep</span>: <span class="hljs-literal">true</span></span></span><br><span class="language-javascript"><span class="language-xml">&#125;)</span></span><br><span class="language-javascript"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>如果想要只侦听state对象中的age属性，可以将第一个参数改为箭头函数，指向要监听的变量</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; ref, watch &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">const</span> state = <span class="hljs-title function_">ref</span>(&#123; <span class="hljs-attr">count</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  state.<span class="hljs-property">value</span>.<span class="hljs-property">count</span>++<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">setAge</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  state.<span class="hljs-property">value</span>.<span class="hljs-property">age</span> = <span class="hljs-number">24</span><br>&#125;<br><span class="hljs-title function_">watch</span>(<br>  <span class="hljs-function">() =&gt;</span> state.<span class="hljs-property">value</span>.<span class="hljs-property">age</span>,<br>  <span class="hljs-function">() =&gt;</span> &#123; <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;age变化了&#x27;</span>); &#125;<br>)<br>&lt;/script&gt;<br></code></pre></td></tr></table></figure>

<h3 id="Vue3生命周期函数"><a href="#Vue3生命周期函数" class="headerlink" title="Vue3生命周期函数"></a>Vue3生命周期函数</h3><table>
<thead>
<tr>
<th align="center">选项式API</th>
<th align="center">组合式API</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>beforeCreate&#x2F;created</strong></td>
<td align="center"><strong>setup</strong></td>
</tr>
<tr>
<td align="center">beforeMount</td>
<td align="center">onBeforeMount</td>
</tr>
<tr>
<td align="center">mounted</td>
<td align="center">onMounted</td>
</tr>
<tr>
<td align="center">beforeUpdate</td>
<td align="center">onBeforeUpdate</td>
</tr>
<tr>
<td align="center">updated</td>
<td align="center">onUpdate</td>
</tr>
<tr>
<td align="center"><strong>beforeUnmount</strong></td>
<td align="center"><strong>onBeforeUnmount</strong></td>
</tr>
<tr>
<td align="center"><strong>unmounted</strong></td>
<td align="center"><strong>onUnmounted</strong></td>
</tr>
</tbody></table>
<p>生命周期函数可以执行多次，多次执行传入的回调会在时机成熟时<strong>依次执行</strong></p>
<ul>
<li><strong>setup</strong>：实在beforeCreate和created阶段之前触发的钩子函数</li>
<li><strong>onBeforeMount</strong>：注册一个钩子，在组件被挂载之前被调用。</li>
<li><strong>onMounted</strong>：注册一个回调函数，在组件挂载完成后执行。</li>
<li><strong>onBeforeUpdate</strong>：注册一个钩子，在组件即将因为响应式状态变更而更新其 DOM 树之前调用。</li>
<li><strong>onUpdate</strong>：注册一个回调函数，在组件因为响应式状态变更而更新其 DOM 树之后调用。</li>
<li><strong>onBeforeUnmount</strong>：注册一个钩子，在组件实例被卸载之前调用。</li>
<li><strong>onUnmounted</strong>：注册一个回调函数，在组件实例被卸载之后调用。</li>
</ul>
<h3 id="父子通信"><a href="#父子通信" class="headerlink" title="父子通信"></a>父子通信</h3><h4 id="父传子"><a href="#父传子" class="headerlink" title="父传子"></a>父传子</h4><p>父组件中给子组件绑定属性</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> son <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./son.vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">200</span>)<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  count.<span class="hljs-property">value</span>=<span class="hljs-number">2000</span><br> &#125;,<span class="hljs-number">3000</span>)<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>父组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">son</span> <span class="hljs-attr">message</span>=<span class="hljs-string">&quot;father message&quot;</span> <span class="hljs-attr">:count</span>=<span class="hljs-string">&quot;count&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">son</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>子组件中通过props选项接收：通过宏函数defineProps({属性名: 类型})</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">const</span> props=<span class="hljs-title function_">defineProps</span>(&#123;<br>  <span class="hljs-attr">message</span>: <span class="hljs-title class_">String</span>,<br>  <span class="hljs-attr">count</span>:<span class="hljs-title class_">Number</span><br>&#125;)<br><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(props);<br>&lt;/script&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>子组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>父组件传入的数据： &#123;&#123; message &#125;&#125;----&#123;&#123;count&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h4 id="子传父"><a href="#子传父" class="headerlink" title="子传父"></a>子传父</h4><p>父组件中给子组件标签通过@绑定事件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> son1 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./son1.vue&#x27;</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getMessage</span>=(<span class="hljs-params">msg</span>)=&gt;&#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(msg);<br> &#125;<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>父组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!-- 1.绑定自定义事件 --&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">son1</span> @<span class="hljs-attr">getSonMessage</span>=<span class="hljs-string">&quot;getMessage&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">son1</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<p>子组件内部通过$emit方法出触发事件：通过宏函数defineEmits([‘自定义事件名’])</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-comment">// 2.通过defineEmits()拿到emit方法</span><br><span class="hljs-keyword">const</span> emit =<span class="hljs-title function_">defineEmits</span>([<span class="hljs-string">&#x27;getSonMessage&#x27;</span>])<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">sendMsg</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  <span class="hljs-comment">// 3.触发自定义事件，传数据给父组件</span><br>  <span class="hljs-title function_">emit</span>(<span class="hljs-string">&#x27;getSonMessage&#x27;</span>,<span class="hljs-string">&#x27;this is son message&#x27;</span>)<br> &#125;<br>&lt;/script&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;son&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>子组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;sendMsg&quot;</span>&gt;</span>触发自定义事件<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h3 id="模板引用"><a href="#模板引用" class="headerlink" title="模板引用"></a>模板引用</h3><p>通过ref标识获取真实的dom对象或组件实例对象，在onMounted()生命周期函数中获取ref</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> son1 <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./son1.vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; ref,onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">const</span> h2ref = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)<br><span class="hljs-keyword">const</span> son1ref = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">null</span>)<br><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">()=&gt;</span>&#123; <br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(h2ref.<span class="hljs-property">value</span>);<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(son1ref.<span class="hljs-property">value</span>);<br>&#125;)<br>&lt;/script&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;father&quot;</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">h2</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;h2ref&quot;</span>&gt;</span>父组件<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!-- 1.绑定自定义事件 --&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">son1</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;son1ref&quot;</span> @<span class="hljs-attr">getSonMessage</span>=<span class="hljs-string">&quot;getMessage&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">son1</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup&gt;<br>import &#123; ref &#125; from &#x27;vue&#x27;;<br>const name = ref(&#x27;son1&#x27;)<br>const setName = () =&gt; &#123;<br>  name.value=&#x27;son2&#x27;<br>&#125;<br>defineExpose(&#123;<br>  name,setName<br>&#125;)<br>&lt;/script&gt;<br>&lt;template&gt;<br>  &lt;div class=&quot;son&quot;&gt;<br>    &lt;h2&gt;子组件&lt;/h2&gt;<br>  &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<p>并且默认情况下setup语法糖下组件内部的属性和方法是不开放给父组件访问的，可以通过defineExpose编译宏指定那些属性和方法允许访问</p>
<h3 id="provide和reject"><a href="#provide和reject" class="headerlink" title="provide和reject"></a>provide和reject</h3><p>作用：顶层组件向任意的底层组件传递数据和方法，实现跨层组件通信</p>
<p>跨层传递普通数据</p>
<ol>
<li><p>顶层组件通过provide函数提供数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">provide</span>(<span class="hljs-string">&#x27;key&#x27;</span>, 顶层组件中的数据)<br></code></pre></td></tr></table></figure>
</li>
<li><p>底层组件通过inject函数获取数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> message=<span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;key&#x27;</span>)<br></code></pre></td></tr></table></figure></li>
</ol>
<p>跨层传递方法</p>
<p>顶层组件可以向底层组件传递方法，底层组件调用方法修改顶层组件中的数据</p>
<p>在不破坏单向数据流的前提下修改顶层组件的数据，谁的数据谁修改</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">setCount</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>  count.<span class="hljs-property">value</span>++<br>&#125;<br><span class="hljs-title function_">provide</span>(<span class="hljs-string">&#x27;funtion-key&#x27;</span>, setCount)<br><br><span class="hljs-keyword">const</span> setCount = <span class="hljs-title function_">inject</span>(<span class="hljs-string">&#x27;funtion-key&#x27;</span>)<br>    &lt;button @click=<span class="hljs-string">&quot;setCount&quot;</span>&gt;修改顶层数据&lt;/button&gt;<br></code></pre></td></tr></table></figure>

<h2 id="Typescript"><a href="#Typescript" class="headerlink" title="Typescript"></a>Typescript</h2><h3 id="TS简介"><a href="#TS简介" class="headerlink" title="TS简介"></a>TS简介</h3><p>Type+JavaScript，在JS基础上，为JS添加了类型支持</p>
<p>TS是JavaScript的超集</p>
<p>JS是弱类型语言，TS是强类型语言</p>
<p><strong>强类型语言</strong>是一种强制类型定义的语言，一旦某一个变量被定义类型，如果不经过强制转换，则它永远就是该数据类型了，强类型语言包括Java、.net 、Python、C++等语言。</p>
<p><strong>弱类型语言</strong>是一种弱类型定义的语言，某一个变量被定义类型，该变量可以根据环境变化自动进行转换，不需要经过显性强制转换。弱类型语言包括vb、PHP、javascript等语言。</p>
<ul>
<li><p>从编程语言的动静来区分，<strong>TypeScript 属于静态类型的编程语言</strong>，<strong>JavaScript 属于动态类型的编程语言</strong> </p>
</li>
<li><ul>
<li>静态类型：<strong>编译</strong>期做类型检查</li>
<li>动态类型：<strong>执行</strong>期做类型检查</li>
</ul>
</li>
<li><p>代码编译和代码执行的顺序：1 编译 2 执行</p>
</li>
<li><p>对于 JS 来说：需要等到代码真正去执行的时候才能发现错误（晚）</p>
</li>
<li><p>对于 TS 来说：在代码编译的时候（代码执行前）就可以发现错误（早）</p>
</li>
</ul>
<h3 id="类型注解"><a href="#类型注解" class="headerlink" title="类型注解"></a>类型注解</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">let</span> num = <span class="hljs-number">18</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">num</span>: <span class="hljs-built_in">number</span>= <span class="hljs-number">18</span><br></code></pre></td></tr></table></figure>

<ul>
<li>说明：代码中的 <code>: number</code> 就是<strong>类型注解</strong></li>
<li>作用：<strong>为变量添加类型约束</strong>。比如，上述代码中，约定变量 age 的类型为 number 类型</li>
<li>解释：<strong>约定了什么类型，就只能给变量赋值该类型的值，否则，就会报错</strong></li>
<li>约定了类型之后，代码的提示就会非常的清晰</li>
</ul>
<h3 id="类型推论"><a href="#类型推论" class="headerlink" title="类型推论"></a>类型推论</h3><p>在 TS 中，某些没有明确指出类型的地方，<strong>TS 的类型推论机制会帮助提供类型</strong> 换句话说：由于类型推论的存在，有些场合下的类型注解可以省略不写</p>
<p>发生类型推论的 2 种常见场景: </p>
<ol>
<li>声明变量并初始化时</li>
<li>决定函数返回值时</li>
</ol>
<h3 id="定义数组"><a href="#定义数组" class="headerlink" title="定义数组"></a>定义数组</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-comment">// 格式1：数组名：类型[] = [值，...]</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>]<br><br><span class="hljs-comment">// 格式2：数组名：Array&lt;类型&gt; = [值，...]</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr1</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>]<br></code></pre></td></tr></table></figure>

<h3 id="定义联合类型"><a href="#定义联合类型" class="headerlink" title="定义联合类型"></a>定义联合类型</h3><p><code>|</code>（竖线）在 TS 中叫做<strong>联合类型</strong>，即：由两个或多个其他类型组成的类型，表示可以是这些类型中的任意一种</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-comment">// x既可以是number也可以是string类型数据</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">x</span>: (<span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>) = <span class="hljs-string">&#x27;a&#x27;</span><br>x = <span class="hljs-number">100</span><br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: (<span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>)[] = [<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;a&#x27;</span>, <span class="hljs-string">&#x27;c&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>]<br>arr.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;d&#x27;</span>)<br>arr.<span class="hljs-title function_">push</span>(<span class="hljs-number">5</span>)<br><br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: (<span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>)[] = []<br>arr.<span class="hljs-title function_">push</span>(<span class="hljs-string">&#x27;d&#x27;</span>)<br>arr.<span class="hljs-title function_">push</span>(<span class="hljs-number">5</span>)<br></code></pre></td></tr></table></figure>

<h3 id="类型别名"><a href="#类型别名" class="headerlink" title="类型别名"></a>类型别名</h3><p>定义 type 别名 &#x3D; 类型，也可以自定义类型</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">type</span> s = <span class="hljs-built_in">string</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">str</span>: s = <span class="hljs-string">&#x27;hello&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">x</span>: (<span class="hljs-built_in">string</span> | <span class="hljs-built_in">boolean</span> | <span class="hljs-built_in">number</span>) = <span class="hljs-string">&#x27;a&#x27;</span><br><span class="hljs-comment">// 定义自定义类型</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyType</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">boolean</span> | <span class="hljs-built_in">number</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">y</span>: <span class="hljs-title class_">MyType</span> = <span class="hljs-literal">false</span><br><span class="hljs-keyword">export</span> &#123; &#125;<br></code></pre></td></tr></table></figure>

<h3 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-comment">// 普通函数 </span><br><span class="hljs-keyword">function</span> 函数名(形参<span class="hljs-number">1</span>： 类型=默认值， 形参<span class="hljs-number">2</span>：类型=默认值): 返回值类型 &#123; &#125;  <br><span class="hljs-comment">// 如果它可以推论出来，可以省略返回值类型</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params"><span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">100</span></span>): <span class="hljs-built_in">number</span> &#123;<br>    <span class="hljs-keyword">return</span> a + b<br>&#125;<br><br><span class="hljs-comment">// 箭头函数 </span><br><span class="hljs-keyword">const</span> 函数名（形参<span class="hljs-number">1</span>: 类型=默认值, 形参<span class="hljs-number">2</span>: 类型=默认值):返回值类型 =&gt; &#123; &#125;<br><span class="hljs-keyword">const</span> f1 = (<span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span>): <span class="hljs-function"><span class="hljs-params">number</span> =&gt;</span> &#123; <span class="hljs-keyword">return</span> a + b &#125;<br><br><span class="hljs-comment">// 定义自定义类型 只适用于箭头函数</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyFunc</span> = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span><br><span class="hljs-keyword">const</span> <span class="hljs-attr">f3</span>: <span class="hljs-title class_">MyFunc</span> = <span class="hljs-function">(<span class="hljs-params">a, b</span>) =&gt;</span> &#123; <span class="hljs-keyword">return</span> a + b &#125;<br></code></pre></td></tr></table></figure>

<h4 id="如果函数没有返回值，就设置为void类型"><a href="#如果函数没有返回值，就设置为void类型" class="headerlink" title="如果函数没有返回值，就设置为void类型"></a>如果函数没有返回值，就设置为void类型</h4><ul>
<li>不写return</li>
<li>写return，但是后面不接内容</li>
<li>写return undefined</li>
</ul>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-comment">// 普通函数</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">f4</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">void</span>&#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;f&#x27;</span>)<br>&#125;<br><span class="hljs-comment">// 箭头函数</span><br><span class="hljs-keyword">const</span> f5 = (): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;f&#x27;</span>)<br>&#125;<br><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyFn</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span><br><span class="hljs-keyword">const</span> <span class="hljs-attr">f6</span>: <span class="hljs-title class_">MyFn</span> = <span class="hljs-function">() =&gt;</span> &#123; &#125;<br></code></pre></td></tr></table></figure>

<h4 id="可选参数"><a href="#可选参数" class="headerlink" title="可选参数"></a>可选参数</h4><p>如果想要一个参数是可选的，就在形参后面加个?，这个参数就可传可不传</p>
<p>并且可选参数和默认值不能同时写</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params"><span class="hljs-attr">a</span>?: <span class="hljs-built_in">number</span>, <span class="hljs-attr">b</span>?: <span class="hljs-built_in">number</span></span>) =&gt; &#123;<br>        <span class="hljs-keyword">return</span> a + b<br>    &#125;<br>    <span class="hljs-title function_">fn</span>()<br>    <span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>)<br>    <span class="hljs-title function_">fn</span>(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="定义的对象"><a href="#定义的对象" class="headerlink" title="定义的对象"></a>定义的对象</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-comment">// 格式：对象名：&#123;属性名: 类型&#125;= &#123;属性名: 值，...&#125;</span><br>    <span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zs&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">obj1</span>: &#123; <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> &#125; = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zs&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">20</span> &#125;<br>    obj1.<span class="hljs-property">age</span> = <span class="hljs-number">28</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">obj2</span>: &#123; <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> &#125; = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;ls&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">25</span> &#125;<br>    <span class="hljs-keyword">type</span> <span class="hljs-title class_">ObjType</span> = &#123; <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">address</span>: <span class="hljs-built_in">number</span> &#125;<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">obj3</span>: <span class="hljs-title class_">ObjType</span> = &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;ws&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>, <span class="hljs-attr">address</span>: <span class="hljs-number">8</span> &#125;<br>    obj3.<span class="hljs-property">age</span> = <span class="hljs-number">29</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">fn</span> = (<span class="hljs-params"><span class="hljs-attr">g</span>: <span class="hljs-title class_">ObjType</span></span>) =&gt; &#123;<br>        g.<span class="hljs-property">address</span> = <span class="hljs-number">16</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>如果对象中要求写方法</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs tsx">   <span class="hljs-comment">// 格式：对象名：&#123;属性名: 类型; 方法名: () =&gt; 返回值类型; 方法名():返回值类型&#125;= &#123;属性名: 值，...&#125;</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">ObjType</span> = &#123;<br>       <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>,<br>       <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>,<br>       <span class="hljs-attr">address</span>: <span class="hljs-built_in">number</span>,<br>       <span class="hljs-attr">hello</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">string</span>,<br>       <span class="hljs-title function_">say</span>():<span class="hljs-built_in">void</span><br>   &#125;<br>   <span class="hljs-keyword">let</span> <span class="hljs-attr">obj3</span>: <span class="hljs-title class_">ObjType</span> = &#123;<br>       <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;ws&#x27;</span>,<br>       <span class="hljs-attr">age</span>: <span class="hljs-number">28</span>,<br>       <span class="hljs-attr">address</span>: <span class="hljs-number">8</span>,<br>       <span class="hljs-attr">hello</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;abc&#x27;</span> &#125;,<br>       <span class="hljs-attr">say</span>: <span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) &#123; &#125;<br>   &#125;<br></code></pre></td></tr></table></figure>

<p>对象的可选属性，在属性后面加个?</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">type</span> <span class="hljs-title class_">Student</span> = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>,<br>    <span class="hljs-attr">gender</span>: <span class="hljs-built_in">string</span>,<br>    <span class="hljs-attr">score</span>?: <span class="hljs-built_in">number</span>,<br>    <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>,<br>    <span class="hljs-attr">study</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>,<br>    <span class="hljs-attr">play</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span><br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">s1</span>: <span class="hljs-title class_">Student</span> = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zs&#x27;</span>,<br>    <span class="hljs-attr">age</span>: <span class="hljs-number">26</span>,<br>    <span class="hljs-attr">gender</span>: <span class="hljs-string">&#x27;男&#x27;</span>,<br>    <span class="hljs-comment">// score: 99,</span><br>    <span class="hljs-attr">height</span>: <span class="hljs-number">178</span>,<br>    <span class="hljs-attr">study</span>: <span class="hljs-function">() =&gt;</span> &#123; &#125;,<br>    <span class="hljs-attr">play</span>: <span class="hljs-function">() =&gt;</span> &#123; &#125;<br>&#125;<br><span class="hljs-keyword">export</span> &#123; &#125;<br></code></pre></td></tr></table></figure>

<h3 id="接口类型interface"><a href="#接口类型interface" class="headerlink" title="接口类型interface"></a>接口类型interface</h3><p>当一个对象类型被多次使用时，一般会使用接口（<code>interface</code>）来描述对象的类型，达到复用的目的</p>
<ul>
<li>解释：</li>
</ul>
<ol>
<li><ol>
<li>使用 <code>interface</code> 关键字来声明接口</li>
<li>接口名称(比如，此处的 IPerson)，可以是任意合法的变量名称，推荐以 <code>I</code> 开头</li>
<li>声明接口后，直接使用接口名称作为变量的类型</li>
<li>因为每一行只有一个属性类型，因此，属性类型后没有 ;(分号)</li>
</ol>
</li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IStudent</span>  &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">gender</span>: <span class="hljs-built_in">string</span>,<br>    <span class="hljs-attr">score</span>?: <span class="hljs-built_in">number</span>, <span class="hljs-attr">height</span>: <span class="hljs-built_in">number</span>,<br>    <span class="hljs-attr">study</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span>, <span class="hljs-attr">play</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span><br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">s1</span>: <span class="hljs-title class_">IStudent</span> = &#123;<br>    <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;zs&#x27;</span>, <span class="hljs-attr">age</span>: <span class="hljs-number">26</span>, <span class="hljs-attr">gender</span>: <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-comment">// score: 99,</span><br>    <span class="hljs-attr">height</span>: <span class="hljs-number">178</span>, <span class="hljs-attr">study</span>: <span class="hljs-function">() =&gt;</span> &#123; &#125;, <span class="hljs-attr">play</span>: <span class="hljs-function">() =&gt;</span> &#123; &#125;<br>&#125;<br><span class="hljs-keyword">export</span> &#123; &#125;<br></code></pre></td></tr></table></figure>

<h4 id="interface和type的区别"><a href="#interface和type的区别" class="headerlink" title="interface和type的区别"></a>interface和type的区别</h4><ul>
<li>interface只能定义对象，type不限于对象，也可自定义其他的类型</li>
<li>interface可以继承，type不可以继承</li>
</ul>
<h4 id="接口继承"><a href="#接口继承" class="headerlink" title="接口继承"></a>接口继承</h4><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IPoint2D</span> &#123;<br>    <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>,<br>    <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span><br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">p1</span>: <span class="hljs-title class_">IPoint2D</span> = &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">50</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">30</span> &#125;<br><span class="hljs-comment">// interface 接口1 extends 接口2 &#123;</span><br><span class="hljs-comment">//     接口1自己的类型</span><br><span class="hljs-comment">//  &#125;</span><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IPoint3D</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">IPoint2D</span> &#123;<br>    <span class="hljs-attr">z</span>:<span class="hljs-built_in">number</span><br> &#125;<br><span class="hljs-comment">// 此时IPoint3D接口如下</span><br><span class="hljs-comment">// interface IPoint3D &#123;</span><br><span class="hljs-comment">//     x: number,</span><br><span class="hljs-comment">//     y: number,</span><br><span class="hljs-comment">//     z: number</span><br><span class="hljs-comment">// &#125;</span><br><span class="hljs-keyword">const</span> <span class="hljs-attr">p2</span>: <span class="hljs-title class_">IPoint3D</span> = &#123; <span class="hljs-attr">x</span>: <span class="hljs-number">20</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">30</span>, <span class="hljs-attr">z</span>: <span class="hljs-number">40</span> &#125;<br></code></pre></td></tr></table></figure>

<h3 id="元组类型"><a href="#元组类型" class="headerlink" title="元组类型"></a>元组类型</h3><p>元组：一种特殊的数组，约定了元素的个数和对应的类型</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-comment">// 比如地图经纬度</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">position</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">121.1324</span>, <span class="hljs-number">134.1234</span>]<br>    <span class="hljs-comment">// number[] 只能表示一个数组，元素是number类型</span><br>    <span class="hljs-comment">// 需求：一个数组，两个元素，第一个是数值，第二个也是数值</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-attr">c1</span>: [<span class="hljs-built_in">number</span>, <span class="hljs-built_in">number</span>] = [<span class="hljs-number">123</span>, <span class="hljs-number">87</span>]<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="字面量类型"><a href="#字面量类型" class="headerlink" title="字面量类型"></a>字面量类型</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-comment">// let str1=&#x27;Hello TS&#x27;</span><br><span class="hljs-comment">// str1是string类型</span><br><span class="hljs-comment">// const str2 = &#x27;Hello TS&#x27;</span><br><span class="hljs-comment">// str2是&#x27;Hello TS&#x27;类型，就是字面量类型</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">str1</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">&#x27;Hello TS&#x27;</span><br><span class="hljs-keyword">const</span> <span class="hljs-attr">str2</span>: <span class="hljs-string">&#x27;Hello TS&#x27;</span> = <span class="hljs-string">&#x27;Hello TS&#x27;</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyType1</span> = <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">MyType2</span> = <span class="hljs-string">&#x27;Hello TS&#x27;</span> | <span class="hljs-number">100</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">m1</span>: <span class="hljs-title class_">MyType2</span> = <span class="hljs-number">100</span><br></code></pre></td></tr></table></figure>

<p>字面量类型单独没有使用场景<br> 一般和联合类型一起使用，表示多个固定的值中取一个</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">type</span> gender = <span class="hljs-string">&#x27;男&#x27;</span> | <span class="hljs-string">&#x27;女&#x27;</span><br><span class="hljs-keyword">let</span> <span class="hljs-attr">s1</span>:gender=<span class="hljs-string">&#x27;女&#x27;</span><br></code></pre></td></tr></table></figure>



<h3 id="枚举类型"><a href="#枚举类型" class="headerlink" title="枚举类型"></a>枚举类型</h3><p>枚举的功能类似于<strong>字面量类型+联合类型组合</strong>的功能，也可以表示一组明确的可选值</p>
<p>枚举：定义一组命名常量。它描述一个值，该值可以是这些命名常量中的一个</p>
<ol>
<li>使用 <code>enum</code> 关键字定义枚举</li>
<li>约定枚举名称以大写字母开头</li>
<li>枚举中的多个值之间通过 <code>,</code>（逗号）分隔</li>
<li>定义好枚举后，直接使用枚举名称作为类型注解</li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-comment">// type Directive = &#x27;up&#x27; | &#x27;down&#x27; | &#x27;left&#x27; | &#x27;right&#x27;</span><br>    <span class="hljs-comment">// 枚举类型</span><br>    <span class="hljs-keyword">enum</span> <span class="hljs-title class_">Directive</span> &#123; <span class="hljs-string">&#x27;up&#x27;</span>, <span class="hljs-string">&#x27;down&#x27;</span>, <span class="hljs-string">&#x27;left&#x27;</span>, <span class="hljs-string">&#x27;right&#x27;</span> &#125;<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">d2</span>: <span class="hljs-title class_">Directive</span> = <span class="hljs-title class_">Directive</span>.<span class="hljs-property">down</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>枚举比较奇怪，这个类型有值，</p>
<ol>
<li>ts中的类型声明语句转成js后会丢弃，而枚举类型不会</li>
<li>枚举是有值的，可以输出打印，用了枚举以后代码体积会变大</li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-keyword">type</span> <span class="hljs-title class_">Directive</span> = <span class="hljs-string">&#x27;up&#x27;</span> | <span class="hljs-string">&#x27;down&#x27;</span> | <span class="hljs-string">&#x27;left&#x27;</span> | <span class="hljs-string">&#x27;right&#x27;</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">d1</span>:<span class="hljs-title class_">Directive</span>=<span class="hljs-string">&quot;right&quot;</span><br>    <span class="hljs-comment">// 枚举类型</span><br>    <span class="hljs-keyword">enum</span> directive &#123; <span class="hljs-string">&#x27;up&#x27;</span>, <span class="hljs-string">&#x27;down&#x27;</span>, <span class="hljs-string">&#x27;left&#x27;</span>, <span class="hljs-string">&#x27;right&#x27;</span> &#125;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(directive)<br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">d2</span>: directive = directive.<span class="hljs-property">down</span><br>&#125;<br><span class="hljs-comment">// ts文件转换后的js文件</span><br>&#123;<br>    <span class="hljs-keyword">var</span> d1 = <span class="hljs-string">&quot;right&quot;</span>;<br>    <span class="hljs-comment">// 枚举类型</span><br>    <span class="hljs-keyword">var</span> directive = <span class="hljs-built_in">void</span> <span class="hljs-number">0</span>;<br>    (<span class="hljs-keyword">function</span> (<span class="hljs-params">directive</span>) &#123;<br>        directive[directive[<span class="hljs-string">&quot;up&quot;</span>] = <span class="hljs-number">0</span>] = <span class="hljs-string">&quot;up&quot;</span>;<br>        directive[directive[<span class="hljs-string">&quot;down&quot;</span>] = <span class="hljs-number">1</span>] = <span class="hljs-string">&quot;down&quot;</span>;<br>        directive[directive[<span class="hljs-string">&quot;left&quot;</span>] = <span class="hljs-number">2</span>] = <span class="hljs-string">&quot;left&quot;</span>;<br>        directive[directive[<span class="hljs-string">&quot;right&quot;</span>] = <span class="hljs-number">3</span>] = <span class="hljs-string">&quot;right&quot;</span>;<br>    &#125;)(directive || (directive = &#123;&#125;));<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(directive)<br>    <span class="hljs-keyword">var</span> d2 = directive.<span class="hljs-property">down</span>;<br>&#125;<br><span class="hljs-comment">// 枚举对象directive的值</span><br>&#123;<br>  <span class="hljs-string">&#x27;0&#x27;</span>: <span class="hljs-string">&#x27;up&#x27;</span>,<br>  <span class="hljs-string">&#x27;1&#x27;</span>: <span class="hljs-string">&#x27;down&#x27;</span>,<br>  <span class="hljs-string">&#x27;2&#x27;</span>: <span class="hljs-string">&#x27;left&#x27;</span>,<br>  <span class="hljs-string">&#x27;3&#x27;</span>: <span class="hljs-string">&#x27;right&#x27;</span>,<br>  <span class="hljs-attr">up</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">down</span>: <span class="hljs-number">1</span>,<br>  <span class="hljs-attr">left</span>: <span class="hljs-number">2</span>,<br>  <span class="hljs-attr">right</span>: <span class="hljs-number">3</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="any类型"><a href="#any类型" class="headerlink" title="any类型"></a>any类型</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123; <br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: &#123;<span class="hljs-attr">a</span>:<span class="hljs-built_in">number</span>&#125; = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;<br>    obj.<span class="hljs-property">b</span>=<span class="hljs-number">200</span><br>&#125;<br>&#123; <br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-built_in">any</span> = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span> &#125;<br>    obj.<span class="hljs-property">b</span>=<span class="hljs-number">200</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>以上操作都不会有任何类型错误提示，即使可能存在错误</p>
<p>尽可能的避免使用 any 类型，除非临时使用 any 来“避免”书写很长、很复杂的类型</p>
<p>有些时候可以临时写一下，</p>
<ul>
<li>前端没有明确拿到后端的数据的时候，不知道使用什么类型来保存可以先用下any，让代码通过</li>
</ul>
<p>有些时候就该是any</p>
<ul>
<li><code>console.log()</code>它的参数就是any</li>
</ul>
<p>其他隐式具有 any 类型的情况 </p>
<ul>
<li>声明变量不提供类型也不提供默认值</li>
<li>函数参数不加类型</li>
</ul>
<p>类型认值的类型时，使用as制定范围更小的类型</p>
<h3 id="类型断言"><a href="#类型断言" class="headerlink" title="类型断言"></a>类型断言</h3><p>在知道获取元素的类型时，使用as制定范围更小的类型</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123; <br>    <span class="hljs-comment">// const img = document.getElementById(&#x27;img&#x27;)</span><br>    <span class="hljs-comment">// document.getElementById获取到的是HTMLElement类型</span><br>    <span class="hljs-comment">// HTMLElement类型没有src属性</span><br>    <span class="hljs-comment">// HTMLElement类型 ===&gt; HTML元素</span><br>    <span class="hljs-keyword">const</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&#x27;img&#x27;</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">HTMLImageElement</span><br>    img.<span class="hljs-property">src</span>=<span class="hljs-string">&#x27;www.baidu.com&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Typescript进阶"><a href="#Typescript进阶" class="headerlink" title="Typescript进阶"></a>Typescript进阶</h2><h3 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h3><p>泛型：宽泛的类型，就是类型是不固定的，不写死的，不是任意类型</p>
<p>可以适用于多个类型，使用<strong>类型变量</strong>(比如T)捕获传入的类型，之后就可以继续使用这个类型。</p>
<p>本质是<strong>参数化类型</strong>，通俗的讲，就是所操作的数据类型被指定为一个参数，这种参数类型可以用在类、接口和函数的创建中，分别成为<strong>泛型类</strong>，<strong>泛型接口</strong>、<strong>泛型函数</strong></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">function</span> 函数名&lt;类型变量<span class="hljs-number">1</span>,类型变量<span class="hljs-number">2</span>,...&gt;(参数<span class="hljs-number">1</span>:类型<span class="hljs-number">1</span>,参数<span class="hljs-number">2</span>:类型<span class="hljs-number">2</span>,...): 返回值类型 &#123;<br>  <br>&#125;<br><br><span class="hljs-keyword">function</span> id&lt;T&gt;(<span class="hljs-attr">value</span>: T): T &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-property">length</span>);<br>    <span class="hljs-keyword">return</span> value<br>&#125;<br><span class="hljs-keyword">const</span> r1 = id&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">const</span> r2 = id&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;abc&#x27;</span>)<br><span class="hljs-keyword">const</span> r3 = id&lt;<span class="hljs-built_in">boolean</span>&gt;(<span class="hljs-literal">true</span>)<br><span class="hljs-comment">// 没有明确传入T，但是因为类型推论，TS可以推出来数据的类型</span><br><span class="hljs-keyword">let</span> r4 = <span class="hljs-title function_">id</span>(<span class="hljs-literal">true</span>)<br></code></pre></td></tr></table></figure>

<h3 id="泛型约束"><a href="#泛型约束" class="headerlink" title="泛型约束"></a>泛型约束</h3><p>解释：Type 可以代表任意类型，无法保证一定存在 length 属性，比如 number 类型就没有 length</p>
<p>此时，就需要<strong>为泛型添加约束来</strong><code>收缩类型</code><strong>(缩窄类型取值范围)</strong></p>
<p>添加泛型约束收缩类型，主要有以下两种方式：</p>
<ul>
<li>指定更加具体的类型，如T[]，要求传入的是一个数组</li>
<li>添加约束，使用interface，从指定接口继承属性</li>
</ul>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-keyword">function</span> id&lt;T&gt;(<span class="hljs-attr">value</span>: T[]): T[] &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-property">length</span>);<br>        <span class="hljs-keyword">return</span> value<br>    &#125;<br>    <span class="hljs-comment">// 要求传入元素是string类型的数组</span><br>    <span class="hljs-keyword">const</span> r1=id&lt;<span class="hljs-built_in">string</span>&gt;([<span class="hljs-string">&#x27;a&#x27;</span>])<br>    <span class="hljs-comment">// 要求传入元素是number类型的数组</span><br>    <span class="hljs-keyword">const</span> r2=id&lt;<span class="hljs-built_in">number</span>&gt;([<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>])<br> &#125;<br>&#123;<br>    <span class="hljs-keyword">interface</span> <span class="hljs-title class_">ILength</span> &#123;<span class="hljs-attr">length</span>:<span class="hljs-built_in">number</span>,<span class="hljs-attr">age</span>:<span class="hljs-built_in">number</span> &#125;<br>    <span class="hljs-keyword">function</span> id&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-title class_">ILength</span>&gt;(<span class="hljs-attr">value</span>: T): T &#123;<br>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(value.<span class="hljs-property">length</span>);<br>        <span class="hljs-keyword">return</span> value<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>多个泛型</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-keyword">function</span> id&lt;T&gt;(<span class="hljs-attr">value</span>: T): T &#123;<br>        <span class="hljs-keyword">return</span> value<br>    &#125;<br>    id&lt;<span class="hljs-built_in">string</span>&gt;(<span class="hljs-string">&#x27;abc&#x27;</span>)<br>    <br>    <span class="hljs-keyword">function</span> f&lt;<span class="hljs-title class_">Type</span>, <span class="hljs-title class_">Result</span>&gt;(<span class="hljs-attr">a</span>: <span class="hljs-title class_">Type</span>, <span class="hljs-attr">b</span>: <span class="hljs-title class_">Result</span>): [<span class="hljs-title class_">Type</span>, <span class="hljs-title class_">Result</span>] &#123;<br>        <span class="hljs-keyword">return</span> [a,b]<br>    &#125;<br>    <span class="hljs-comment">// 类型推论</span><br>    <span class="hljs-keyword">const</span> r1=<span class="hljs-title function_">f</span>(<span class="hljs-number">100</span>,<span class="hljs-literal">false</span>)<br>&#125;<br><span class="hljs-comment">// 多个泛型变量相互约束</span><br><span class="hljs-comment">// keyof Obj 就是拿到Obj中所有key的集合</span><br>&#123;<br>    <span class="hljs-keyword">let</span> obj = &#123; <span class="hljs-attr">a</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">b</span>: <span class="hljs-number">2</span> ,<span class="hljs-attr">c</span>: <span class="hljs-string">&#x27;abc&#x27;</span> &#125;<br>    <span class="hljs-keyword">function</span> getProp&lt;<span class="hljs-title class_">Obj</span>, <span class="hljs-title class_">Key</span> <span class="hljs-keyword">extends</span> keyof <span class="hljs-title class_">Obj</span>&gt;(<span class="hljs-attr">obj</span>: <span class="hljs-title class_">Obj</span>, <span class="hljs-attr">prop</span>: <span class="hljs-title class_">Key</span>): <span class="hljs-built_in">any</span> &#123;<br>        <span class="hljs-keyword">return</span> obj[prop]<br>    &#125;<br>    <span class="hljs-comment">// Key中是&#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;</span><br>    <span class="hljs-comment">// 希望prop只能是obj中已有的属性</span><br>    <span class="hljs-title function_">getProp</span>(obj, <span class="hljs-string">&#x27;a&#x27;</span>)<br>    <br>    <span class="hljs-keyword">type</span> <span class="hljs-title class_">MyType</span> = &#123; <span class="hljs-attr">a</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">b</span>: <span class="hljs-built_in">string</span> &#125;<br>    <span class="hljs-keyword">type</span> K = keyof <span class="hljs-title class_">MyType</span><br>    <span class="hljs-comment">// 这个时候K就是MyType中key组成的一个新的类型</span><br>    <span class="hljs-comment">// type K = &#x27;a&#x27; | &#x27;b&#x27;</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: K = <span class="hljs-string">&#x27;b&#x27;</span><br>    <span class="hljs-keyword">let</span> <span class="hljs-attr">b</span>: K = <span class="hljs-string">&#x27;a&#x27;</span><br>&#125;<br></code></pre></td></tr></table></figure>

<p>泛型练习</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs tsx">&#123;<br>    <span class="hljs-comment">// useState它接收一个任意类型的数据，返回一个数组。</span><br>    <span class="hljs-comment">// 数组的第一个元素的类型与入参一致； </span><br>    <span class="hljs-comment">// 数组的第二个元素是一个函数</span><br>    <span class="hljs-comment">// 这个函数的入参类型和返回值类型与useState的入参一致</span><br>    <span class="hljs-comment">// 传入的value类型是T，返回元组类型[T, (val: T) =&gt; T]，第一个参数是传入的类型T，第二个参数是一个函数，返回传入的类型T</span><br>    <span class="hljs-keyword">function</span> useState&lt;T&gt;(<span class="hljs-attr">value</span>: T): [T, <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">val</span>: T</span>) =&gt;</span> T] &#123;<br>        <span class="hljs-keyword">const</span> setValue = (<span class="hljs-attr">val</span>: T): <span class="hljs-function"><span class="hljs-params">T</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> val<br>        &#125;<br>        <span class="hljs-keyword">return</span> [value, setValue]<br>    &#125;<br>    <span class="hljs-keyword">const</span> [str, setStr] = <span class="hljs-title function_">useState</span>(<span class="hljs-string">&#x27;123&#x27;</span>)<br>    <span class="hljs-keyword">const</span> [num, setNum] = <span class="hljs-title function_">useState</span>(<span class="hljs-number">123</span>)<br>&#125;<br><span class="hljs-keyword">export</span> &#123; &#125;<br></code></pre></td></tr></table></figure>

<h3 id="泛型接口"><a href="#泛型接口" class="headerlink" title="泛型接口"></a>泛型接口</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">interface</span> <span class="hljs-title class_">IFunct</span>&lt;<span class="hljs-title class_">Type</span>&gt; &#123;<br>    <span class="hljs-attr">id</span>: <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">value</span>: <span class="hljs-title class_">Type</span></span>) =&gt;</span> <span class="hljs-title class_">Type</span><br>    <span class="hljs-attr">ids</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Type</span>[]<br>&#125;<br><span class="hljs-keyword">const</span> <span class="hljs-attr">m</span>: <span class="hljs-title class_">IFunct</span>&lt;<span class="hljs-built_in">string</span>&gt; = &#123;<br>    <span class="hljs-attr">id</span>:  <span class="hljs-function"><span class="hljs-params">val</span> =&gt;</span> val,<br>    <span class="hljs-attr">ids</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">string</span>[]<br>&#125;<br>m.<span class="hljs-title function_">id</span>(<span class="hljs-string">&#x27;abc&#x27;</span>)<br><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>:<span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt;=[<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;b&#x27;</span>,<span class="hljs-string">&#x27;c&#x27;</span>]<br></code></pre></td></tr></table></figure>

<h2 id="Vite创建项目"><a href="#Vite创建项目" class="headerlink" title="Vite创建项目"></a>Vite创建项目</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">npm create vite<br></code></pre></td></tr></table></figure>

<h3 id="TS下props的使用"><a href="#TS下props的使用" class="headerlink" title="TS下props的使用"></a>TS下props的使用</h3><p>JS写法：</p>
<p><code>defineProps(&#123; money: &#123; type: Number, required: true &#125;&#125;)</code></p>
<p>TS写法：</p>
<p><code>const &#123;money, car=&#39;默认值&#39;&#125; = defineProps&lt;money:number,car?:string&gt;()</code></p>
<p><code>vite.config.json添加配置 reactivityTransform: true</code>当没有传值时使用默认值</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-title function_">defineProps</span>(&#123;<br>    <span class="hljs-attr">money</span>: &#123;<br>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">Number</span>,<br>        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span><br>    &#125;<br>&#125;)<br>defineProps&lt;&#123; <span class="hljs-attr">money</span>: <span class="hljs-built_in">number</span> &#125;&gt;()<br><span class="hljs-comment">// 如果想要给可选参数设置默认值</span><br><span class="hljs-keyword">const</span> &#123;money, car=<span class="hljs-string">&#x27;默认值&#x27;</span>&#125; = defineProps&lt;<span class="hljs-attr">money</span>:<span class="hljs-built_in">number</span>,<span class="hljs-attr">car</span>?:<span class="hljs-built_in">string</span>&gt;()<br></code></pre></td></tr></table></figure>

<h3 id="TS下emits的使用"><a href="#TS下emits的使用" class="headerlink" title="TS下emits的使用"></a>TS下emits的使用</h3><p>JS写法：</p>
<p><code>const emit = defineEmits([&#39;事件名1&#39;,&#39;事件名2&#39;])</code><br><code>emit(&#39;事件名1&#39;, 实参)</code></p>
<p>TS写法：</p>
<p><code>const emit = defineEmits&lt;&#123; (e: &#39;事件名&#39;, 变量名: 类型): void &#125;&gt;()</code></p>
<p><code>emit(&#39;事件名&#39;, 实参)</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&quot;ts&quot;&gt;<br>const emit = defineEmits([&#x27;event1&#x27;])<br>const hClick = () =&gt; &#123;<br>    emit(&#x27;event1&#x27;, 12000)<br>&#125;<br><br>const emit = defineEmits&lt;&#123;<br>    (e: &#x27;event1&#x27;, money: number): void<br>&#125;&gt;()<br>const hClick = () =&gt; &#123;<br>    emit(&#x27;event1&#x27;, 12000)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="TS下ref的使用"><a href="#TS下ref的使用" class="headerlink" title="TS下ref的使用"></a>TS下ref的使用</h3><p>js写法：</p>
<p><code>const todos=ref([])</code></p>
<p>TS写法：</p>
<p><code>ref&lt;&#123;变量: 类型&#125;[]&gt;([])</code></p>
<p><code>const todos = ref&lt;&#123; id: number, content: string, isDone: boolean &#125;[]&gt;([])</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">const</span> todos=<span class="hljs-title function_">ref</span>([])<br><span class="hljs-comment">// 不赋值页面会报错</span><br><br><span class="hljs-keyword">const</span> todos = ref&lt;&#123; <span class="hljs-attr">id</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">isDone</span>: <span class="hljs-built_in">boolean</span> &#125;[]&gt;([])<br><span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    todos.<span class="hljs-property">value</span> = [&#123; <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">&#x27;吃饭&#x27;</span>, <span class="hljs-attr">isDone</span>: <span class="hljs-literal">false</span> &#125;, &#123; <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">content</span>: <span class="hljs-string">&#x27;睡觉&#x27;</span>, <span class="hljs-attr">isDone</span>: <span class="hljs-literal">true</span> &#125;]<br>&#125;, <span class="hljs-number">3000</span>)<br></code></pre></td></tr></table></figure>

<h3 id="TS下computed的使用"><a href="#TS下computed的使用" class="headerlink" title="TS下computed的使用"></a>TS下computed的使用</h3><p>JS写法：<code>computed(()=&gt;&#123; return... &#125;)</code></p>
<p>TS写法:<code>computed&lt;返回值类型&gt;(()=&gt;&#123; return... &#125;)</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">const</span> leftCount = computed&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> todos.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">isDone</span>).<span class="hljs-property">length</span><br>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="TS下的事件处理函数"><a href="#TS下的事件处理函数" class="headerlink" title="TS下的事件处理函数"></a>TS下的事件处理函数</h3><p>TS写法：</p>
<p><code>&lt;button @mousemove=&quot;hMouseMove($event)&quot;&gt;按钮&lt;/button&gt;</code></p>
<p><code>const hMouseMove = (e:MouseEvent) =&gt; &#123; console.log(e.pageX,e.pageY); &#125;</code></p>
<p>$event是一个特殊的变量，写在回调函数中，固定名字，表示当前对象</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&quot;ts&quot;&gt;<br>const hMouseMove = (e:MouseEvent) =&gt; &#123;<br>console.log(e.pageX,e.pageY);<br>&#125;<br>const h1 = (e: KeyboardEvent) =&gt; &#123;<br>    console.log(e);<br> &#125;<br>&lt;/script&gt;<br>&lt;template&gt;<br>    &lt;input type=&quot;text&quot; @keydown=&quot;h1($event)&quot;&gt;<br>    &lt;button @mousemove=&quot;hMouseMove($event)&quot;&gt;按钮&lt;/button&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h3 id="TS下的通过ref获取dom"><a href="#TS下的通过ref获取dom" class="headerlink" title="TS下的通过ref获取dom"></a>TS下的通过ref获取dom</h3><p>TS写法：</p>
<p><code>const hRef = ref&lt;null | HTMLHeadElement&gt;(null)</code></p>
<p><code>&lt;h1 ref=&quot;hRef&quot;&gt;ref&lt;/h1&gt;</code></p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">const</span> hRef = ref&lt;<span class="hljs-literal">null</span> | <span class="hljs-title class_">HTMLHeadElement</span>&gt;(<span class="hljs-literal">null</span>)<br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;h1&#x27;</span>) <span class="hljs-comment">// HTMLHeadElement</span><br></code></pre></td></tr></table></figure>

<p>ref用于获取页面中元素时，有两个状态：1.初始状态 null 2.绑定后的状态</p>
<p>可以通过document.createElement(对应标签名)的vscode提示得到DOM对象的类型</p>
<h4 id="可选链操作符"><a href="#可选链操作符" class="headerlink" title="可选链操作符?"></a>可选链操作符?</h4><p><code>iptRef.value?.innerHTML</code></p>
<p><code>JavaScript</code> 会在尝试访问 <code>iptRef.value.innerHTML</code> 之前，先隐式地检查并确定 <code>iptRef.value</code> 既不是 <code>null</code> 也不是 <code>undefined</code>。如果<code>iptRef.value</code> 是 <code>null</code> 或者 <code>undefined</code>，表达式将会短路计算直接返回 <code>undefined</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup lang=&quot;ts&quot;&gt;<br>import &#123; ref &#125; from &#x27;vue&#x27;<br>const hRef = ref&lt;null | HTMLHeadElement&gt;(null)<br>const clickFn = () =&gt; &#123;<br>    console.log(iptRef.value?.innerHTML);<br>&#125;<br><br>&lt;/script&gt;<br>&lt;template&gt;<br>    &lt;h1 ref=&quot;hRef&quot;&gt;ref&lt;/h1&gt;<br>    &lt;button @click=&quot;clickFn&quot;&gt;点击&lt;/button&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h3 id="Typescript类型声明文件"><a href="#Typescript类型声明文件" class="headerlink" title="Typescript类型声明文件"></a>Typescript类型声明文件</h3><p>import导入包后的加载过程</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-comment">// 1.在node_modules/axios中找到package.json</span><br><span class="hljs-comment">// 2.在package.json中找到main字段对应的文件</span><br><span class="hljs-comment">//    找到node_modules/axios/lib/axios.js</span><br><span class="hljs-comment">// 3.在引入.js文件的同时，会载入types字段指定的index.d.ts</span><br><span class="hljs-comment">// 此时就有了类型提示</span><br></code></pre></td></tr></table></figure>

<p>用来为已存在的 JS 库提供类型信息。包括内置类型声明文件、第三方库类型声明文件和自定义类型声明文件</p>
<p>如果要为 JS 库提供类型信息，要使用 <code>.d.ts</code> 文件</p>
<p>内置类型声明文件：TS 为 JS 运行时可用的所有标准化内置 API 都提供了声明文件</p>
<p>第三方库类型声明文件：1. 库自带类型声明文件 2. 由 TS官方给它写的</p>
<p>自定义类型声明文件</p>
<p>如下两种场景需要提供自定义类型声明文件</p>
<ol>
<li>项目内共享类型</li>
<li>为已有 JS 文件提供类型声明</li>
</ol>
<p>如何基于现有的.js提供声明文件?</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// utils/index.js</span><br><span class="hljs-keyword">let</span> count = <span class="hljs-number">10</span><br><span class="hljs-keyword">let</span> songName = <span class="hljs-string">&#x27;痴心绝对&#x27;</span><br><span class="hljs-keyword">let</span> position = &#123;<br>  <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">y</span>: <span class="hljs-number">0</span><br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span>(<span class="hljs-params">x, y</span>) &#123;<br>  <span class="hljs-keyword">return</span> x + y<br>&#125;<br><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">changeDirection</span>(<span class="hljs-params">direction</span>) &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(direction)<br>&#125;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">fomartPoint</span> = point =&gt; &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;当前坐标：&#x27;</span>, point)<br>&#125;<br><br><span class="hljs-keyword">export</span> &#123; count, songName, position, add, changeDirection, fomartPoint &#125;<br></code></pre></td></tr></table></figure>

<p>思路：编写同名的.d.ts文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript">demo.<span class="hljs-property">ts</span><br>utils/index.<span class="hljs-property">js</span><br>utils/index.<span class="hljs-property">d</span>.<span class="hljs-property">ts</span> <span class="hljs-comment">// 这里是重点</span><br></code></pre></td></tr></table></figure>

<ol>
<li><p>它的作用是提供声明，不需要提供逻辑代码；</p>
</li>
<li><p>declare 关键字:用于类型声明，为其他地方(比如.js 文件)已存在的变量声明类型，而不是创建一个新的变量。</p>
</li>
<li><ol>
<li>对于 type、interface 等这些明确就是 TS 类型的(只能在 TS 中使用的)，可以省略 declare 关键字。</li>
<li>对于 let、function 等具有双重含义(在 JS、TS 中都能用)，应该使用 declare 关键字，明确指定此处用于类型声明。</li>
</ol>
</li>
</ol>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs tsx"><span class="hljs-comment">// util/index.d.ts</span><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">let</span> <span class="hljs-attr">count</span>:<span class="hljs-built_in">number</span><br><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">let</span> <span class="hljs-attr">songName</span>: <span class="hljs-built_in">string</span><br><br><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Position</span> &#123;<br>  <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>,<br>  <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span><br>&#125;<br><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">let</span> <span class="hljs-attr">position</span>: <span class="hljs-title class_">Position</span><br><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">add</span> (<span class="hljs-params">x :<span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span></span>) : <span class="hljs-built_in">number</span><br><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">Direction</span> = <span class="hljs-string">&#x27;left&#x27;</span> | <span class="hljs-string">&#x27;right&#x27;</span> | <span class="hljs-string">&#x27;top&#x27;</span> | <span class="hljs-string">&#x27;bottom&#x27;</span><br><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">changeDirection</span> (<span class="hljs-params"><span class="hljs-attr">direction</span>: <span class="hljs-title class_">Direction</span></span>): <span class="hljs-built_in">void</span><br><br><span class="hljs-keyword">type</span> <span class="hljs-title class_">FomartPoint</span> = <span class="hljs-function">(<span class="hljs-params"><span class="hljs-attr">point</span>: <span class="hljs-title class_">Position</span></span>) =&gt;</span> <span class="hljs-built_in">void</span><br><br><span class="hljs-keyword">declare</span> <span class="hljs-keyword">const</span> <span class="hljs-attr">fomartPoint</span>: <span class="hljs-title class_">FomartPoint</span><br><br><span class="hljs-keyword">export</span> &#123;<br>  count, songName, position, add, changeDirection, fomartPoint<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="Pinia"><a href="#Pinia" class="headerlink" title="Pinia"></a>Pinia</h2><p>pinia是Vue的专属的状态管理库，是Vuex状态管理工具的替代品</p>
<p>优势：</p>
<ol>
<li>提供了更加简单的API（去掉了mutations）</li>
<li>提供符合组合式风格的API（和Vue3新语法统一）</li>
<li>去掉了modules的概念，每一个store都是一个独立的模块</li>
<li>搭配Typescript一起使用提供可靠的类型推断</li>
</ol>
<h3 id="pinia的使用"><a href="#pinia的使用" class="headerlink" title="pinia的使用"></a>pinia的使用</h3><p>pinia安装</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">npm install pinia<br></code></pre></td></tr></table></figure>

<p>在main.js中注册</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; createPinia &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">const</span> pinia=<span class="hljs-title function_">createPinia</span>()<br><span class="hljs-title function_">createApp</span>(<span class="hljs-title class_">App</span>).<span class="hljs-title function_">use</span>(pinia).<span class="hljs-title function_">mount</span>(<span class="hljs-string">&#x27;#app&#x27;</span>)<br></code></pre></td></tr></table></figure>

<p>新建stores&#x2F;counter.js</p>
<ul>
<li>state数据通过ref定义响应式数据</li>
<li>getters数据通过computed计算属性方法定义</li>
<li>将所有定义的变量和方法全部return出去</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-keyword">import</span> &#123; defineStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123; computed, ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCounterStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;counter&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-comment">// state属性</span><br>    <span class="hljs-keyword">const</span> count = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<br>    <span class="hljs-comment">// actions同步方法</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">increment</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>        count.<span class="hljs-property">value</span>++<br>    &#125;<br>    <span class="hljs-comment">// actions异步方法</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-variable constant_">API_URL</span> = <span class="hljs-string">&#x27;http://geek.itheima.net/v1_0/channels&#x27;</span><br>    <span class="hljs-keyword">const</span> list = <span class="hljs-title function_">ref</span>([])<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getList</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-variable constant_">API_URL</span>)<br>        <span class="hljs-comment">// console.log(res);</span><br>        list.<span class="hljs-property">value</span>=res.<span class="hljs-property">data</span>.<span class="hljs-property">data</span>.<span class="hljs-property">channels</span><br>     &#125;<br>    <span class="hljs-comment">// getters计算属性</span><br>    <span class="hljs-keyword">const</span> computedCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> count.<span class="hljs-property">value</span> * <span class="hljs-number">2</span>)<br>    <span class="hljs-keyword">return</span> &#123;<br>        count,<br>        increment,<br>        computedCount,<br>        list,<br>        getList<br>    &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>在页面中导入使用</p>
<ul>
<li><p>如果直接解构赋值，会丢失数据的响应式</p>
<p><code>const &#123; count, computedCount &#125; = counterStore</code></p>
</li>
<li><p>使用storeToRef方法包裹保持数据响应式</p>
<p><code>const &#123; count, computedCount &#125; = storeToRefs(counterStore)</code></p>
</li>
<li><p>方法直接从原来的counterStore中解构赋值<br><code>const &#123; increment &#125; = counterStore</code></p>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; useCounterStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./stores/counter&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; storeToRefs &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span>;<br><span class="hljs-comment">// 执行方法得到store实例对象</span><br><span class="hljs-keyword">const</span> counterStore = <span class="hljs-title function_">useCounterStore</span>()<br><span class="hljs-comment">// 直接解构赋值 响应式的丢失</span><br><span class="hljs-comment">// const &#123; count, computedCount &#125; = counterStore</span><br><span class="hljs-comment">// 方法包裹 保持响应式更细</span><br><span class="hljs-keyword">const</span> &#123; count, computedCount &#125; = <span class="hljs-title function_">storeToRefs</span>(counterStore)<br><span class="hljs-comment">// 方法直接从原来的counterStore中解构赋值</span><br><span class="hljs-keyword">const</span> &#123; increment &#125; = counterStore<br><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>  counterStore.<span class="hljs-title function_">getList</span>()<br> &#125;)<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;increment&quot;</span>&gt;</span>&#123;&#123; count &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;increment&quot;</span>&gt;</span>&#123;&#123; computedCount &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">  <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in counterStore.list&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item.id&quot;</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h2 id="项目开始"><a href="#项目开始" class="headerlink" title="项目开始"></a>项目开始</h2><h3 id="项目别名路径联想设置"><a href="#项目别名路径联想设置" class="headerlink" title="项目别名路径联想设置"></a>项目别名路径联想设置</h3><p>新建jsconfig.json文件</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;compilerOptions&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;baseUrl&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;./&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;paths&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>            <span class="hljs-attr">&quot;@/*&quot;</span><span class="hljs-punctuation">:</span><span class="hljs-punctuation">[</span><br>                <span class="hljs-string">&quot;src/*&quot;</span><br>            <span class="hljs-punctuation">]</span><br>        <span class="hljs-punctuation">&#125;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;exclude&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><br>        <span class="hljs-string">&quot;node_modeules&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-string">&quot;dist&quot;</span><br>    <span class="hljs-punctuation">]</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<p>安装elementPlus和按需导入的包</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js">yarn add elementPlus<br>npm install -D unplugin-vue-components unplugin-auto-<span class="hljs-keyword">import</span><br></code></pre></td></tr></table></figure>

<p>在vite.config.js中配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// vite.config.ts</span><br><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-auto-import/vite&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/vite&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ElementPlusResolver</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/resolvers&#x27;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-comment">// ...</span><br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-comment">// ...</span><br>    <span class="hljs-title class_">AutoImport</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],<br>    &#125;),<br>    <span class="hljs-title class_">Components</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],<br>    &#125;),<br>  ],<br>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="定制elementPlus主题"><a href="#定制elementPlus主题" class="headerlink" title="定制elementPlus主题"></a>定制elementPlus主题</h3><p>新建styles&#x2F;element&#x2F;index.scss</p>
<figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-comment">/* 只需要重写你需要的即可 */</span><br><span class="hljs-keyword">@forward</span> <span class="hljs-string">&#x27;element-plus/theme-chalk/src/common/var.scss&#x27;</span> with (<br>  <span class="hljs-variable">$colors</span>: (<br>    <span class="hljs-string">&#x27;primary&#x27;</span>: (<br>      // 主色<br>      <span class="hljs-string">&#x27;base&#x27;</span>: <span class="hljs-number">#27ba9b</span>,<br>    ),<br>    <span class="hljs-string">&#x27;success&#x27;</span>: (<br>      // 成功色<br>      <span class="hljs-string">&#x27;base&#x27;</span>: <span class="hljs-number">#1dc779</span>,<br>    ),<br>    <span class="hljs-string">&#x27;warning&#x27;</span>: (<br>      // 警告色<br>      <span class="hljs-string">&#x27;base&#x27;</span>: <span class="hljs-number">#ffb302</span>,<br>    ),<br>    <span class="hljs-string">&#x27;danger&#x27;</span>: (<br>      // 危险色<br>      <span class="hljs-string">&#x27;base&#x27;</span>: <span class="hljs-number">#e26237</span>,<br>    ),<br>    <span class="hljs-string">&#x27;error&#x27;</span>: (<br>      // 错误色<br>      <span class="hljs-string">&#x27;base&#x27;</span>: <span class="hljs-number">#cf4444</span>,<br>    ),<br>  )<br>)<br></code></pre></td></tr></table></figure>

<p>在vite.config.js中配置</p>
<p>在plugins节点下面的Components配置<code>resolvers: [ElementPlusResolver(&#123;importStyle:&quot;sass&quot;&#125;)],</code></p>
<p>添加css节点，在prepocessorOptions预处理器添加scss，使用 <code>scss.additionalData</code> 来编译所有应用 scss 变量的组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; fileURLToPath, <span class="hljs-variable constant_">URL</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;node:url&#x27;</span><br><br><span class="hljs-keyword">import</span> &#123; defineConfig &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vite&#x27;</span><br><span class="hljs-keyword">import</span> vue <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@vitejs/plugin-vue&#x27;</span><br><span class="hljs-comment">// 配置elementPlus按需导入</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">AutoImport</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-auto-import/vite&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Components</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/vite&#x27;</span><br><span class="hljs-keyword">import</span> &#123; <span class="hljs-title class_">ElementPlusResolver</span> &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;unplugin-vue-components/resolvers&#x27;</span><br><span class="hljs-comment">// https://vitejs.dev/config/</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-title function_">defineConfig</span>(&#123;<br>  <span class="hljs-attr">plugins</span>: [<br>    <span class="hljs-title function_">vue</span>(),<br>    <span class="hljs-title class_">AutoImport</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>()],<br>    &#125;),<br>    <span class="hljs-title class_">Components</span>(&#123;<br>      <span class="hljs-attr">resolvers</span>: [<span class="hljs-title class_">ElementPlusResolver</span>(&#123;<span class="hljs-attr">importStyle</span>:<span class="hljs-string">&quot;sass&quot;</span>&#125;)],<br>    &#125;),<br>  ],<br>  ......<br>  <span class="hljs-attr">css</span>: &#123;<br>    <span class="hljs-attr">preprocessorOptions</span>: &#123;<br>      <span class="hljs-attr">scss</span>: &#123;<br>        <span class="hljs-attr">additionalData</span>:<span class="hljs-string">`@use &quot;@/styles/element/index.scss&quot; as *;`</span><br>      &#125;<br>    &#125;<br>  &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="axios封装"><a href="#axios封装" class="headerlink" title="axios封装"></a>axios封装</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;axios&#x27;</span><br><span class="hljs-keyword">const</span> httpInstance = axios.<span class="hljs-title function_">create</span>(&#123;<br>    <span class="hljs-attr">baseURL</span>: <span class="hljs-string">&#x27;http://pcapi-xiaotuxian-front-devtest.itheima.net&#x27;</span>,<br>    <span class="hljs-attr">timeout</span>: <span class="hljs-number">5000</span><br>&#125;)<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> httpInstance<br></code></pre></td></tr></table></figure>

<p>如果项目里面不同的业务需要不同的接口基地址不同：</p>
<p>axios.create()方法可以执行多次，每次执行就会生成一个新的实例</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> http1=axios.<span class="hljs-title function_">create</span>(&#123;<span class="hljs-attr">baseURL</span>:<span class="hljs-string">&#x27;url1&#x27;</span>&#125;)<br><span class="hljs-keyword">const</span> http2=axios.<span class="hljs-title function_">create</span>(&#123;<span class="hljs-attr">baseURL</span>:<span class="hljs-string">&#x27;url2&#x27;</span>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="scss文件自动导入"><a href="#scss文件自动导入" class="headerlink" title="scss文件自动导入"></a>scss文件自动导入</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-attr">css</span>: &#123;<br>  <span class="hljs-attr">preprocessorOptions</span>: &#123;<br>    <span class="hljs-attr">scss</span>: &#123;<br>      <span class="hljs-attr">additionalData</span>: <span class="hljs-string">`</span><br><span class="hljs-string">         @use &quot;@/styles/element/index.scss&quot; as *;</span><br><span class="hljs-string">         @use &quot;@/styles/var.scss&quot; as *;</span><br><span class="hljs-string">         `</span>,<br>    &#125;,<br>  &#125;,<br>&#125;,<br></code></pre></td></tr></table></figure>

<h3 id="纯展示类组件调用封装思路"><a href="#纯展示类组件调用封装思路" class="headerlink" title="纯展示类组件调用封装思路"></a>纯展示类组件调用封装思路</h3><ol>
<li>搭建纯静态的部分，不管可变的部分</li>
<li>抽离可变的部分为组件参数，非复杂的文本抽离成props，复杂的结构抽象为插槽</li>
</ol>
<p>路由缓存问题</p>
<p>当页面从category&#x2F;1005000跳转到category&#x2F;1005002时，只有参数发生变化，相同的组件实例将被重复使用，两个路由渲染同一个组件，组件得到生命周期钩子函数不会被调用，导致分类数据无法更新。</p>
<p>解决思路：</p>
<ol>
<li>让组件实例不复用，强制销毁重建</li>
<li>监听路由变化，变化之后执行数据更新操作</li>
</ol>
<p>解决方案1：</p>
<p>添加key，破坏复用机制，强制销毁重建</p>
<p>问题：整个页面网络请求都会重新发送，浪费资源</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;router-view :key=&quot;$route.fullPath&quot;&gt;&lt;/router-view&gt;<br></code></pre></td></tr></table></figure>

<p>解决方案2：</p>
<p>beforeRouteUpdate导航钩子，在每次更新路由前执行，在回调中执行需要数据更新的业务逻辑即可</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; onBeforeRouteUpdate, useRoute &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getSecondCategory</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id = route.params.id</span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getSecondCategoryAPI</span>(id)<br>    <span class="hljs-comment">// console.log(res);</span><br>    categoryData.<span class="hljs-property">value</span> = res.<span class="hljs-property">result</span><br>&#125;<br><span class="hljs-comment">// 监听路由参数变化，重新发送请求分类数据</span><br><span class="hljs-title function_">onBeforeRouteUpdate</span>(<span class="hljs-function">(<span class="hljs-params">to</span>) =&gt;</span> &#123;<br>    <span class="hljs-comment">// 存在问题:使用最新的路由参数请求最新的分类数据</span><br>    <span class="hljs-title function_">getSecondCategory</span>(to.<span class="hljs-property">params</span>.<span class="hljs-property">id</span>)<br>&#125;)<br></code></pre></td></tr></table></figure>

<p>解决方案3</p>
<p>使用watch监听路由变化，发送请求，可以实现效果</p>
<p>问题：跳转首页后控制台报错，因为首页是一级路由’&#x2F;‘，分类页面是’&#x2F;category&#x2F;105000’，没有route.params.id</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">watch</span>(<br>    route, <span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-title function_">getSecondCategory</span>()<br>    &#125;<br>)<br></code></pre></td></tr></table></figure>

<h3 id="使用逻辑函数拆分业务"><a href="#使用逻辑函数拆分业务" class="headerlink" title="使用逻辑函数拆分业务"></a>使用逻辑函数拆分业务</h3><p>实现步骤</p>
<ol>
<li>按照业务声明以use打头的逻辑函数</li>
<li>把独立的业务逻辑封装到各个函数内部</li>
<li>函数内部把组件中需要用到的数据或方法return出去</li>
<li>在组件中调用函数把数据或者方法组合回来使用</li>
</ol>
<h3 id="无限滚动实现"><a href="#无限滚动实现" class="headerlink" title="无限滚动实现"></a>无限滚动实现</h3><ul>
<li>el-tabs组件的v-model属性关联el-tab-pane组件的name属性，也是请求二级分类数据reqData.sortFields属性。切换tab栏时触发tab-click事件重新请求二级分类商品数据</li>
<li>请求回来的数据需要与原goodsList进行合并</li>
<li>使用elementPlus组件的v-infinite-scroll&#x3D;”load”指令进行无限滚动，当前<code>reqData.page*reqData.pageSize</code>大于数据最多数量maxCount时，判断加载完成，设置infinite-scroll-disabled&#x3D;”disabled”禁用无限滚动</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup&gt;<br>import &#123; getCategoryFilterAPI, geySubCatetoryAPI &#125; from &#x27;@/apis&#x27;;<br>import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;<br>......<br>const goodsList = ref([])<br>const maxCount = ref(0)<br>const disabled = ref(false)<br>// 请求数据对象<br>const reqData = ref(&#123;<br>    catetoryId: route.params.id,<br>    page: 1,<br>    pageSize: 20,<br>    sortField: &#x27;publishTime&#x27;<br>&#125;)<br>const getGoodsList = async () =&gt; &#123;<br>    const res = await geySubCatetoryAPI(reqData)<br>    maxCount.value = res.result.counts<br>    goodsList.value = [...goodsList.value, ...res.result.items]<br>&#125;<br>onMounted(() =&gt; getGoodsList())<br>const tabChange = () =&gt; &#123;<br>    getGoodsList()<br>&#125;    <br>const load = () =&gt; &#123;<br>    reqData.value.page++<br>    getGoodsList()<br>    // 如果没有更多数据了，禁用无限滚动<br>    if (reqData.value.page * reqData.value.pageSize &gt; maxCount.value) &#123;<br>        disabled.value = true<br>    &#125;<br>&#125;<br>&lt;/script&gt;<br><br>&lt;template&gt;<br>    &lt;div class=&quot;container &quot;&gt;<br>		......<br>        &lt;div class=&quot;sub-container&quot;&gt;<br>            &lt;el-tabs v-model=&quot;reqData.sortField&quot; @tab-click=&quot;tabChange&quot;&gt;<br>                &lt;el-tab-pane label=&quot; 最新商品&quot; name=&quot;publishTime&quot;&gt;&lt;/el-tab-pane&gt;<br>                &lt;el-tab-pane label=&quot;最高人气&quot; name=&quot;orderNum&quot;&gt;&lt;/el-tab-pane&gt;<br>                &lt;el-tab-pane label=&quot;评论最多&quot; name=&quot;evaluateNum&quot;&gt;&lt;/el-tab-pane&gt;<br>            &lt;/el-tabs&gt;<br>            &lt;div class=&quot;body&quot; v-infinite-scroll=&quot;load&quot; :infinite-scroll-disabled=&quot;disabled&quot;&gt;<br>                &lt;!-- 商品列表--&gt;<br>                &lt;GoodsItem v-for=&quot;item in goodsList&quot; :key=&quot;item.id&quot; :goods=&quot;item&quot;&gt;&lt;/GoodsItem&gt;<br>            &lt;/div&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h3 id="二级分类-定制路由滚动行为"><a href="#二级分类-定制路由滚动行为" class="headerlink" title="二级分类-定制路由滚动行为"></a>二级分类-定制路由滚动行为</h3><p>在不同路由切换时，可以自动滚动到页面的顶部，而不是停留在原先的位置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">&#123;<br>  <span class="hljs-title function_">scrollBehavior</span>(<span class="hljs-params"></span>) &#123;<br>    <span class="hljs-keyword">return</span> &#123;<br>      <span class="hljs-attr">top</span>: <span class="hljs-number">0</span><br>    &#125;<br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="封装复杂组件"><a href="#封装复杂组件" class="headerlink" title="封装复杂组件"></a>封装复杂组件</h3><h4 id="通用思路"><a href="#通用思路" class="headerlink" title="通用思路"></a>通用思路</h4><ol>
<li>功能拆解</li>
<li>寻找核心实现思路</li>
<li>寻找关键技术</li>
<li>逐个实现，逐个验证，最后优化</li>
</ol>
<h4 id="图片预览组件的封装逻辑"><a href="#图片预览组件的封装逻辑" class="headerlink" title="图片预览组件的封装逻辑"></a>图片预览组件的封装逻辑</h4><p>功能拆解：</p>
<ol>
<li><p>小图切换大图显示</p>
<p>ul的li身上绑定mouseenter事件，经过哪张图片时就将当前图片的索引activeIndex赋值给左侧大图显示<code>&lt;img :src=&quot;imageList[activeIndex]&quot; alt=&quot;&quot; /&gt;</code></p>
</li>
<li><p>放大镜效果实现</p>
<p>使用useMouseInElement(target)获取到鼠标相对于当前盒子的<code>elementX, elementY, isOutside</code>，当isOutside为false时展示大图预览，并且展示蒙层小盒子，当移动鼠标时，获取鼠标的相对位移，操控蒙层小盒子的top和left。大图预览时图片的移动方向和鼠标移动方向相反，设置<code>const positionX = computed(() =&gt; &#123; return -left.value * 2 &#125;)</code>和<code>const positionY = computed(() =&gt; &#123; return -top.value * 2 &#125;)</code>赋值给大盒子的backgroundPositionX和backgroundPositionY，实现效果。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup&gt;<br>import &#123; ref, watch, computed &#125; from &#x27;vue&#x27;;<br>import &#123; useMouseInElement &#125; from &#x27;@vueuse/core&#x27;<br>// 图片列表<br>defineProps(&#123;<br>    imageList: &#123;<br>        type: Array,<br>        default:()=&gt;([])<br>    &#125;<br>&#125;)<br>// 1.小图切换大图显示<br>const activeIndex = ref(0)<br>const enterImage = (i) =&gt; &#123;<br>    activeIndex.value = i<br>&#125;<br>// 2.放大镜效果实现-滑块跟随鼠标移动<br>// 获取鼠标相对位置，控制滑块跟随移动<br>const target = ref(null)<br>const left = ref(0)<br>const top = ref(0)<br>const &#123; elementX, elementY, isOutside &#125; = useMouseInElement(target)<br>// 3.控制滑块跟随鼠标移动(监听elementX/Y变化，一旦变化，重新设置left/top)<br>watch([elementX, elementY, isOutside], () =&gt; &#123;<br>    // 如果鼠标没有移入到盒子里，直接不执行后面逻辑<br>    if (isOutside.value) return<br>    // 有效移动距离计算<br>    if (elementX.value &gt; 100 &amp;&amp; elementX.value &lt; 300) &#123;<br>        left.value = elementX.value - 100<br>    &#125;<br>    if (elementY.value &gt; 100 &amp;&amp; elementY.value &lt; 300) &#123;<br>        top.value = elementY.value - 100<br>    &#125;<br>    // 边界距离控制<br>    if (elementX.value &gt; 300) &#123; left.value = 200 &#125;<br>    if (elementX.value &lt; 100) &#123; left.value = 0 &#125;<br>    if (elementY.value &gt; 300) &#123; top.value = 200 &#125;<br>    if (elementY.value &lt; 100) &#123; top.value = 0 &#125;<br>&#125;)<br>// 控制大图显示<br>const positionX = computed(() =&gt; &#123;<br>    return -left.value * 2<br>&#125;)<br>const positionY = computed(() =&gt; &#123;<br>    return -top.value * 2<br>&#125;)<br>&lt;/script&gt;<br>&lt;template&gt;<br>    &lt;div class=&quot;goods-image&quot;&gt;<br>        &lt;!-- 左侧大图--&gt;<br>        &lt;div class=&quot;middle&quot; ref=&quot;target&quot;&gt;<br>            &lt;img :src=&quot;imageList[activeIndex]&quot; alt=&quot;&quot; /&gt;<br>            &lt;!-- 蒙层小滑块 --&gt;<br>            &lt;!-- 如果鼠标移出盒子范围，就隐藏蒙层 --&gt;<br>            &lt;div class=&quot;layer&quot; :style=&quot;&#123; left: `$&#123;left&#125;px`, top: `$&#123;top&#125;px` &#125;&quot; v-show=&quot;!isOutside&quot;&gt;&lt;/div&gt;<br>        &lt;/div&gt;<br>        &lt;!-- 小图列表 --&gt;<br>        &lt;ul class=&quot;small&quot;&gt;<br>            &lt;li v-for=&quot;(img, i) in imageList&quot; :key=&quot;i&quot; @mouseenter=&quot;enterImage(i)&quot; :class=&quot;&#123; active: activeIndex === i &#125;&quot;&gt;<br>                &lt;img :src=&quot;img&quot; alt=&quot;&quot; /&gt;<br>            &lt;/li&gt;<br>        &lt;/ul&gt;<br>        &lt;!-- 放大镜大图 --&gt;<br>        &lt;div class=&quot;large&quot; :style=&quot;[&#123;<br>                backgroundImage: `url($&#123;imageList[activeIndex]&#125;)`,<br>                backgroundPositionX: `$&#123;positionX&#125;px`,<br>                backgroundPositionY: `$&#123;positionY&#125;px`,<br>            &#125;,]&quot; v-show=&quot;!isOutside&quot;&gt;&lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h3 id="SKU组件"><a href="#SKU组件" class="headerlink" title="SKU组件"></a>SKU组件</h3><p>存活单位(stock keeping unit)，也翻译为库存单元，是一个会计学名词，定义为库存管理中打的最小可用单元，例如纺织品中的一个SKU通常表示规格、颜色、款式，而在零售门店中有时称单品位一个SKU</p>
<p>作用：产出当前用户选择的商品规格，为加入购物车操作提供数据信息</p>
<p>遇到别人写好的组件，首先重点看props和emit，props决定了当前组件接收什么数据，emit决定了会产出什么数据</p>
<p>验证组件是否使用成功：传入必要数据是否交互功能正常，点击选择规格，是否正常产出数据</p>
<h3 id="共用组件全局注册"><a href="#共用组件全局注册" class="headerlink" title="共用组件全局注册"></a>共用组件全局注册</h3><p>在src&#x2F;components文件夹下面新建index.js，通过插件的形式将components中的所有组件进行全局化注册</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">ImagePreview</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./ImagePreview/index.vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">XtxSku</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./XtxSku/index.vue&#x27;</span><br><span class="hljs-keyword">import</span> <span class="hljs-title class_">Banner</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./Banner.vue&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> componentPlugin = &#123;<br>    <span class="hljs-title function_">install</span>(<span class="hljs-params">app</span>) &#123;<br>        <span class="hljs-comment">// app.component(&#x27;组件名字&#x27;,&#x27;组件配置对象&#x27;)</span><br>        app.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;ImagePreview&#x27;</span>, <span class="hljs-title class_">ImagePreview</span>),<br>        app.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;XtxSku&#x27;</span>, <span class="hljs-title class_">XtxSku</span>),<br>        app.<span class="hljs-title function_">component</span>(<span class="hljs-string">&#x27;Banner&#x27;</span>, <span class="hljs-title class_">Banner</span>)<br>     &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>然后再main.js中导入全局注册</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; componentPlugin &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./components&#x27;</span><br>app.<span class="hljs-title function_">use</span>(componentPlugin)<br></code></pre></td></tr></table></figure>

<h3 id="登录表单校验"><a href="#登录表单校验" class="headerlink" title="登录表单校验"></a>登录表单校验</h3><h4 id="全局校验"><a href="#全局校验" class="headerlink" title="全局校验"></a>全局校验</h4><p>在点击登录按钮时进行全局校验，使用Form组件自带的校验方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">loginFn</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    formRef.<span class="hljs-property">value</span>.<span class="hljs-title function_">validate</span>(<span class="hljs-title function_">async</span> (valid) =&gt; &#123;<br>        <span class="hljs-keyword">if</span> (valid) &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">await</span>  userStore.<span class="hljs-title function_">getUserInfo</span>(&#123;<br>                    <span class="hljs-attr">account</span>: userForm.<span class="hljs-property">value</span>.<span class="hljs-property">account</span>,<br>                    <span class="hljs-attr">password</span>: userForm.<span class="hljs-property">value</span>.<span class="hljs-property">password</span><br>                &#125;)<br>                <span class="hljs-title class_">ElMessage</span>.<span class="hljs-title function_">success</span>(<span class="hljs-string">&#x27;用户登录成功&#x27;</span>)<br>                router.<span class="hljs-title function_">replace</span>(&#123; <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span> &#125;)<br>            &#125; <span class="hljs-keyword">catch</span> (err) &#123;<br>                <span class="hljs-comment">// console.log(err)</span><br>            &#125;<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span><br>        &#125;<br>    &#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h4 id="pinia管理用户数据"><a href="#pinia管理用户数据" class="headerlink" title="pinia管理用户数据"></a>pinia管理用户数据</h4><p>在pinia中定义异步的actions方法，调用时传入账户名和密码，将返回的用户信息存到state中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; defineStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123; loginAPI &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/apis&#x27;</span>;<br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> userInfo = <span class="hljs-title function_">ref</span>(&#123;&#125;)<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getUserInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">&#123; account, password &#125;</span>) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginAPI</span>(&#123; account, password &#125;)<br>        userInfo.<span class="hljs-property">value</span> = res.<span class="hljs-property">result</span><br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123; userInfo, getUserInfo &#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h3 id="pinia数据持久化存储"><a href="#pinia数据持久化存储" class="headerlink" title="pinia数据持久化存储"></a>pinia数据持久化存储</h3><p>使用pinia-plugin-persistedstate插件对pinia中的数据进行持久化处理</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> piniaPluginPersistedstate <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia-plugin-persistedstate&#x27;</span><br><span class="hljs-keyword">const</span> pinia=<span class="hljs-title function_">createPinia</span>()<br>app.<span class="hljs-title function_">use</span>(pinia)<br>pinia.<span class="hljs-title function_">use</span>(piniaPluginPersistedstate)<br></code></pre></td></tr></table></figure>

<p>然后再想要持久化存储的pinia中添加配置</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>	......<br>    <span class="hljs-keyword">return</span> &#123; ...... &#125;<br>&#125;,<br>    &#123; <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> &#125;<br>)<br><br></code></pre></td></tr></table></figure>

<h3 id="购物车"><a href="#购物车" class="headerlink" title="购物车"></a>购物车</h3><h4 id="页面铺设"><a href="#页面铺设" class="headerlink" title="页面铺设"></a><strong>页面铺设</strong></h4><p>首先新建头部购物车文件，在Layout页面右上角展示购物车图标，小徽标显示里面商品种类数量。</p>
<p>当鼠标经过购物车图标，并且购物车中商品种类数量大于0并且当前路由路由不是cartlist时，会出现弹出层展示购物车中商品。</p>
<p>在pinia中定义计算属性totalCount和totalPrice，计算购物车中商品的总数量和总价</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// HeaderCart.vue</span><br>&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; useCartStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/stores&#x27;</span><br><span class="hljs-keyword">import</span> &#123; computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">const</span> cartStore = <span class="hljs-title function_">useCartStore</span>()<br><span class="hljs-keyword">const</span> cartLength = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">return</span> cartStore.<span class="hljs-property">cartList</span>.<span class="hljs-property">length</span><br> &#125;)<br>&lt;/script&gt;<br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;cart&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;curr&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;$router.push(&#x27;/cartlist&#x27;)&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">i</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;iconfont icon-cart&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">i</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">em</span>&gt;</span>&#123;&#123; cartLength &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">em</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;layer&quot;</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;cartLength &gt; 0 &amp;&amp; $route.path !== &#x27;/cartlist&#x27;&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;foot&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;total&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>共 &#123;&#123; cartStore.totalCount &#125;&#125; 件商品<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span><span class="hljs-symbol">&amp;yen;</span> &#123;&#123; cartStore.totalPrice.toFixed(2) &#125;&#125; <span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;large&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;$router.push(&#x27;/cartlist&#x27;)&quot;</span>&gt;</span>去购物车结算<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.cart</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">width</span>: <span class="hljs-number">50px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">position</span>: relative;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">z-index</span>: <span class="hljs-number">600</span>;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-selector-class">.curr</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">height</span>: <span class="hljs-number">32px</span>;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">line-height</span>: <span class="hljs-number">32px</span>;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">text-align</span>: center;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">position</span>: relative;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">display</span>: block;</span></span><br><span class="language-css"><span class="language-xml">    &amp;<span class="hljs-selector-pseudo">:hover</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-selector-class">.layer</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">opacity</span>: <span class="hljs-number">1</span>;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">transform</span>: none;</span></span><br><span class="language-css"><span class="language-xml">        &#125;</span></span><br><span class="language-css"><span class="language-xml">    &#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br></code></pre></td></tr></table></figure>

<h4 id="购物车列表页面"><a href="#购物车列表页面" class="headerlink" title="购物车列表页面"></a><strong>购物车列表页面</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><code class="hljs vue">// views/cartList/index.vue中<br>&lt;script setup&gt;<br>import &#123; useCartStore &#125; from &#x27;@/stores&#x27;;<br>import &#123; useRouter &#125; from &#x27;vue-router&#x27;<br>const cartStore = useCartStore()<br>const singleCheck = (i, selected) =&gt; &#123;<br>    cartStore.singleCheck(i.skuId, selected)<br>&#125;<br>const router =useRouter()<br>const totalCheck = (selected) =&gt; &#123;<br>    cartStore.totalCheck(selected)<br>&#125;<br>const orderPayFn = () =&gt; &#123;<br>    if (!cartStore.isLogin) &#123;<br>        router.push(`/login?redirect=$&#123;router.currentRoute.value.fullPath&#125;`)<br>    &#125; else &#123;<br>        router.push(&#x27;/checkout&#x27;)<br>    &#125;<br>&#125;<br>&lt;/script&gt;<br>&lt;template&gt;<br>    &lt;div class=&quot;xtx-cart-page&quot;&gt;<br>        &lt;div class=&quot;container m-top-20&quot;&gt;<br>            &lt;div class=&quot;bread-container&quot;&gt;<br>                &lt;el-breadcrumb separator=&quot;&gt;&quot;&gt;<br>                    &lt;el-breadcrumb-item :to=&quot;&#123; path: &#x27;/&#x27; &#125;&quot;&gt;首页&lt;/el-breadcrumb-item&gt;<br>                    &lt;el-breadcrumb-item&gt;购物车&lt;/el-breadcrumb-item&gt;<br>                &lt;/el-breadcrumb&gt;<br>            &lt;/div&gt;<br>            &lt;div class=&quot;cart&quot;&gt;<br>                &lt;table&gt;<br>                    &lt;thead&gt;<br>                        &lt;tr&gt;<br>                            &lt;th width=&quot;120&quot;&gt;<br>                                &lt;el-checkbox :model-value=&quot;cartStore.totalChecked&quot; @change=&quot;totalCheck&quot; /&gt;<br>                            &lt;/th&gt;<br>                            &lt;th width=&quot;400&quot;&gt;商品信息&lt;/th&gt;<br>                            &lt;th width=&quot;220&quot;&gt;单价&lt;/th&gt;<br>                            &lt;th width=&quot;180&quot;&gt;数量&lt;/th&gt;<br>                            &lt;th width=&quot;180&quot;&gt;小计&lt;/th&gt;<br>                            &lt;th width=&quot;140&quot;&gt;操作&lt;/th&gt;<br>                        &lt;/tr&gt;<br>                    &lt;/thead&gt;<br>                    &lt;!-- 商品列表 --&gt;<br>                    &lt;tbody&gt;<br>                        &lt;tr v-for=&quot;i in cartStore.cartList&quot; :key=&quot;i.id&quot;&gt;<br>                            &lt;td&gt;<br>                                &lt;el-checkbox :model-value=&quot;i.selected&quot; @change=&quot;(selected) =&gt; singleCheck(i, selected)&quot; /&gt;<br>                            &lt;/td&gt;<br>                            &lt;td&gt;<br>                                &lt;div class=&quot;goods&quot;&gt;<br>                                    &lt;RouterLink to=&quot;/&quot;&gt;&lt;img :src=&quot;i.picture&quot; alt=&quot;&quot; /&gt;&lt;/RouterLink&gt;<br>                                    &lt;div&gt;<br>                                        &lt;p class=&quot;name ellipsis&quot;&gt;<br>                                            &#123;&#123; i.name &#125;&#125;<br>                                        &lt;/p&gt;<br>                                    &lt;/div&gt;<br>                                &lt;/div&gt;<br>                            &lt;/td&gt;<br>                            &lt;td class=&quot;tc&quot;&gt;<br>                                &lt;p&gt;&amp;yen;&#123;&#123; i.price &#125;&#125;&lt;/p&gt;<br>                            &lt;/td&gt;<br>                            &lt;td class=&quot;tc&quot;&gt;<br>                                &lt;el-input-number :min=&#x27;1&#x27; v-model=&quot;i.count&quot; /&gt;<br>                            &lt;/td&gt;<br>                            &lt;td class=&quot;tc&quot;&gt;<br>                                &lt;p class=&quot;f16 red&quot;&gt;&amp;yen;&#123;&#123; (i.price * i.count).toFixed(2) &#125;&#125;&lt;/p&gt;<br>                            &lt;/td&gt;<br>                            &lt;td class=&quot;tc&quot;&gt;<br>                                &lt;p&gt;<br>                                    &lt;el-popconfirm title=&quot;确认删除吗?&quot; confirm-button-text=&quot;确认&quot; cancel-button-text=&quot;取消&quot; @confirm=&quot;cartStore.delCart(i.skuId)&quot;&gt;<br>                                        &lt;template #reference&gt;<br>                                            &lt;a href=&quot;javascript:;&quot;&gt;删除&lt;/a&gt;<br>                                        &lt;/template&gt;<br>                                    &lt;/el-popconfirm&gt;<br>                                &lt;/p&gt;<br>                            &lt;/td&gt;<br>                        &lt;/tr&gt;<br>                        &lt;tr v-if=&quot;cartStore.cartList.length === 0&quot;&gt;<br>                            &lt;td colspan=&quot;6&quot;&gt;<br>                                &lt;div class=&quot;cart-none&quot;&gt;<br>                                    &lt;el-empty description=&quot;购物车列表为空&quot;&gt;<br>                                        &lt;el-button type=&quot;primary&quot; @click=&quot;$router.push(&#x27;/&#x27;)&quot;&gt;随便逛逛&lt;/el-button&gt;<br>                                    &lt;/el-empty&gt;<br>                                &lt;/div&gt;<br>                            &lt;/td&gt;<br>                        &lt;/tr&gt;<br>                    &lt;/tbody&gt;<br><br>                &lt;/table&gt;<br>            &lt;/div&gt;<br>            &lt;!-- 操作栏 --&gt;<br>            &lt;div class=&quot;action&quot;&gt;<br>                &lt;div class=&quot;batch&quot;&gt;<br>                    共 &#123;&#123; cartStore.totalCount &#125;&#125; 件商品，已选择 &#123;&#123; cartStore.checkedCount &#125;&#125; 件，商品合计：<br>                    &lt;span class=&quot;red&quot;&gt;¥ &#123;&#123; cartStore.finalPrice.toFixed(2) &#125;&#125; &lt;/span&gt;<br>                &lt;/div&gt;<br>                &lt;div class=&quot;total&quot;&gt;<br>                    &lt;el-button size=&quot;large&quot; type=&quot;primary&quot; @click=&quot;orderPayFn&quot;&gt;下单结算&lt;/el-button&gt;<br>                &lt;/div&gt;<br>            &lt;/div&gt;<br>        &lt;/div&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<h4 id="单选框功能"><a href="#单选框功能" class="headerlink" title="单选框功能"></a>单选框功能</h4><p><strong>单选框功能实现</strong>：</p>
<p>单选框el-checkbox的model-value属性绑定每种商品的selected属性；singleCheck是每种商品前面的单选框的change事件的方法。点击单选框改变选中状态并存到pinia中。</p>
<p><strong>实现方法</strong>：</p>
<ul>
<li>当点击checkbox时传递当前行商品的数据对象和checkbox的选中状态selected（true&#x2F;false）</li>
<li>调用pinia中singleCheck方法，找到cartList中商品skuId等于传进来的商品数据对象的skuId相等的商品数据对象的selected属性赋予传进来的selected单选框状态</li>
</ul>
<h4 id="全选框功能"><a href="#全选框功能" class="headerlink" title="全选框功能"></a>全选框功能</h4><p><strong>全选框功能实现</strong>：</p>
<ul>
<li>所有单选框都选中时，全选框才选中，有一个单选框未选中时全选框就不选中</li>
<li>当点击全选框时，所有单选框都跟着改变</li>
</ul>
<p><strong>实现方法</strong>：</p>
<ul>
<li>定义getters：totalChecked，使用every方法当cartList中所有商品的selected属性都为true时返回true，否则返回false</li>
<li>全选框的model-value绑定getters：totalChecked，totalCheck是全选框的change事件的方法</li>
<li>当点击全选框时totalCheck方法内遍历cartList数组，将每种商品的selected属性赋值传进来的selected属性</li>
</ul>
<h4 id="勾选商品总数量-勾选商品总价"><a href="#勾选商品总数量-勾选商品总价" class="headerlink" title="勾选商品总数量&#x2F;勾选商品总价"></a>勾选商品总数量&#x2F;勾选商品总价</h4><p>定义计算属性checkedCount和finalPrice计算勾选商品总数量和勾选商品总价</p>
<ul>
<li>使用filter过滤除了cartList数组中商品selected为true的商品再使用reduce求勾选商品总数量checkedCount</li>
<li>使用filter过滤除了cartList数组中商品selected为true的商品再使用reduce求勾选商品总价finalPrice（selected为true的商品单价乘商品数量）</li>
</ul>
<h4 id="获取最新购物车"><a href="#获取最新购物车" class="headerlink" title="获取最新购物车"></a>获取最新购物车</h4><p>在pinia中定义getCart方法，当用户登录时，会将通过调用接口返回的购物车数据覆盖本地购物车数据。</p>
<h4 id="添加购物车"><a href="#添加购物车" class="headerlink" title="添加购物车"></a><strong>添加购物车</strong></h4><ul>
<li>用户已登录时，会调用接口，将商品的skuId和商品数量发送给后台，然后重新获取最新的购物车列表</li>
<li>用户未登录时，使用find方法查找cartList中是否有传进来的商品（根据skuId）<ul>
<li>如果没有，将商品数据对象push进cartList中</li>
<li>如果有，就将对应商品的数量count加上传进来的商品数量</li>
</ul>
</li>
</ul>
<h4 id="删除购物车"><a href="#删除购物车" class="headerlink" title="删除购物车"></a><strong>删除购物车</strong></h4><ul>
<li>用户已登录时，会调用接口，将商品的skuId（以数组形式）发送给后台，然后重新获取最新的购物车列表</li>
<li>用户未登录时，使用filter方法将传进来的商品（根据skuId）从cartList过滤出去</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// stores/cart.js</span><br><span class="hljs-keyword">import</span> &#123; defineStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123; ref, computed &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; useUserStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./user&#x27;</span><br><span class="hljs-keyword">import</span> &#123; addCartAPI, delCartAPI, getCartAPI &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/apis&#x27;</span><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useCartStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;cart&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> userStore = <span class="hljs-title function_">useUserStore</span>()<br>    <span class="hljs-keyword">const</span> isLogin = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> userStore.<span class="hljs-property">userInfo</span>.<span class="hljs-property">token</span>)<br>    <span class="hljs-comment">// state</span><br>    <span class="hljs-comment">// 购物车数组</span><br>    <span class="hljs-keyword">const</span> cartList = <span class="hljs-title function_">ref</span>([])<br>    <span class="hljs-comment">// actions</span><br>    <span class="hljs-comment">// 获取最新购物车</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getCart</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getCartAPI</span>()<br>        cartList.<span class="hljs-property">value</span> = res.<span class="hljs-property">result</span><br>    &#125;<br>    <span class="hljs-comment">// 添加购物车</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">addCart</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">goods</span>) =&gt; &#123;<br>        <span class="hljs-comment">// 购物车中已有商品，count+1</span><br>        <span class="hljs-comment">// 没有添加过，直接push</span><br>        <span class="hljs-keyword">if</span> (isLogin.<span class="hljs-property">value</span>) &#123;<br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">addCartAPI</span>(&#123;<br>                <span class="hljs-attr">skuId</span>: goods.<span class="hljs-property">skuId</span>,<br>                <span class="hljs-attr">count</span>: goods.<span class="hljs-property">count</span><br>            &#125;)<br>            <span class="hljs-title function_">getCart</span>()<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">const</span> item = cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> goods.<span class="hljs-property">skuId</span> === item.<span class="hljs-property">skuId</span>)<br>            <span class="hljs-keyword">if</span> (item) &#123;<br>                item.<span class="hljs-property">count</span> += goods.<span class="hljs-property">count</span><br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">push</span>(goods)<br>            &#125;<br>        &#125;<br>    &#125;<br>    <span class="hljs-comment">// 单选</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">singleCheck</span> = (<span class="hljs-params">id, selected</span>) =&gt; &#123;<br>        cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> id === item.<span class="hljs-property">skuId</span>).<span class="hljs-property">selected</span> = selected<br>    &#125;<br>    <span class="hljs-comment">// 全选</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">totalCheck</span> = (<span class="hljs-params">value</span>) =&gt; &#123;<br>        cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">selected</span> = value)<br>    &#125;<br>    <span class="hljs-comment">// 删除购物车</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">delCart</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">id</span>) =&gt; &#123;<br>        <span class="hljs-keyword">if</span> (isLogin.<span class="hljs-property">value</span>) &#123;<br>            <span class="hljs-keyword">await</span> <span class="hljs-title function_">delCartAPI</span>([id])<br>            <span class="hljs-title function_">getCart</span>()<br>        &#125; <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-comment">// 1.找到要删除项的下标值-splice</span><br>            <span class="hljs-comment">// const idx = cartList.value.findIndex((item) =&gt; id === item.skuId)</span><br>            <span class="hljs-comment">// cartList.value.splice(idx,1)</span><br>            <span class="hljs-comment">// 2.使用数组的过滤方法-filter</span><br>            cartList.<span class="hljs-property">value</span> = cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> id !== item.<span class="hljs-property">skuId</span>)<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-comment">// 清空购物车</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearCart</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>        cartList.<span class="hljs-property">value</span> = []<br>    &#125;<br>    <span class="hljs-comment">// getters</span><br>    <span class="hljs-comment">// 商品总数</span><br>    <span class="hljs-keyword">const</span> totalCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">count, item</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> count += item.<span class="hljs-property">count</span><br>        &#125;, <span class="hljs-number">0</span>)<br>    &#125;)<br>    <span class="hljs-comment">// 选中商品数量</span><br>    <span class="hljs-keyword">const</span> checkedCount = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">selected</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">count, item</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> count += item.<span class="hljs-property">count</span><br>        &#125;, <span class="hljs-number">0</span>)<br>    &#125;)<br>    <span class="hljs-comment">// 总价</span><br>    <span class="hljs-keyword">const</span> totalPrice = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">price, item</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> price += item.<span class="hljs-property">price</span> * <span class="hljs-number">1000</span> * item.<span class="hljs-property">count</span> / <span class="hljs-number">1000</span><br>        &#125;, <span class="hljs-number">0</span>)<br>    &#125;)<br>    <span class="hljs-comment">// 结算价格</span><br>    <span class="hljs-keyword">const</span> finalPrice = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">filter</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">selected</span>).<span class="hljs-title function_">reduce</span>(<span class="hljs-function">(<span class="hljs-params">price, item</span>) =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> price += item.<span class="hljs-property">price</span> * <span class="hljs-number">1000</span> * item.<span class="hljs-property">count</span> / <span class="hljs-number">1000</span><br>        &#125;, <span class="hljs-number">0</span>)<br>    &#125;)<br>    <span class="hljs-comment">// 是否全选</span><br>    <span class="hljs-keyword">const</span> totalChecked = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        <span class="hljs-keyword">return</span> cartList.<span class="hljs-property">value</span>.<span class="hljs-title function_">every</span>(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.<span class="hljs-property">selected</span>)<br>    &#125;)<br><br>    <span class="hljs-keyword">return</span> &#123;<br>        isLogin, cartList, addCart, delCart, getCart, singleCheck, totalCheck, clearCart, totalCount, totalPrice, finalPrice, totalChecked, checkedCount<br>    &#125;<br>&#125;,<br>    &#123; <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> &#125;<br>)<br></code></pre></td></tr></table></figure>

<h4 id="合并购物车"><a href="#合并购物车" class="headerlink" title="合并购物车"></a><strong>合并购物车</strong></h4><p>登录时会将本地购物车的数据调用接口合并到登录时的购物车中</p>
<p>退出登录时，除了清空用户的数据信息，还要清空pinia中的购物车数据</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">import</span> &#123; ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span><br><span class="hljs-keyword">import</span> &#123; defineStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;pinia&#x27;</span><br><span class="hljs-keyword">import</span> &#123; loginAPI,mergeCartAPI &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/apis&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; useCartStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./cart&#x27;</span>;<br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> useUserStore = <span class="hljs-title function_">defineStore</span>(<span class="hljs-string">&#x27;user&#x27;</span>, <span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> userInfo = <span class="hljs-title function_">ref</span>(&#123;&#125;)<br>    <span class="hljs-keyword">const</span> cartStore=<span class="hljs-title function_">useCartStore</span>()<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">getUserInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">&#123; account, password &#125;</span>) =&gt; &#123;<br>        <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">loginAPI</span>(&#123; account, password &#125;)<br>        userInfo.<span class="hljs-property">value</span> = res.<span class="hljs-property">result</span><br>        <span class="hljs-keyword">await</span> <span class="hljs-title function_">mergeCartAPI</span>(cartStore.<span class="hljs-property">cartList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">skuId</span>: item.<span class="hljs-property">skuId</span>,<br>                <span class="hljs-attr">selected</span>: item.<span class="hljs-property">selected</span>,<br>                <span class="hljs-attr">count</span>: item.<span class="hljs-property">count</span><br>            &#125;<br>         &#125;))<br>        cartStore.<span class="hljs-title function_">getCart</span>()<br>    &#125;<br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">clearUserInfo</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>        userInfo.<span class="hljs-property">value</span> = &#123;&#125;<br>        cartStore.<span class="hljs-title function_">clearCart</span>()<br>    &#125;<br>    <span class="hljs-keyword">return</span> &#123; userInfo, getUserInfo,clearUserInfo &#125;<br>&#125;,<br>    &#123; <span class="hljs-attr">persist</span>: <span class="hljs-literal">true</span> &#125;<br>)<br></code></pre></td></tr></table></figure>

<p><strong>小技巧</strong>：当需要传递数组，内容是一个对象中的某几个属性时，使用map方法</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs js">cartStore.<span class="hljs-property">cartList</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">skuId</span>: item.<span class="hljs-property">skuId</span>,<br>                <span class="hljs-attr">selected</span>: item.<span class="hljs-property">selected</span>,<br>                <span class="hljs-attr">count</span>: item.<span class="hljs-property">count</span><br>            &#125;<br>         &#125;)<br></code></pre></td></tr></table></figure>

<h3 id="结算模块"><a href="#结算模块" class="headerlink" title="结算模块"></a>结算模块</h3><h4 id="地址渲染"><a href="#地址渲染" class="headerlink" title="地址渲染"></a>地址渲染</h4><p><strong>默认地址渲染</strong>：通过查看生成订单接口返回的数据中包含一个地址数组，中有一个isDefault属性，当isDefault为0时是默认地址</p>
<p><strong>切换地址按钮功能需求</strong>：</p>
<ul>
<li>打开弹框交互：点击切换地址，打开弹窗，回显用户可选地址列表<ul>
<li>弹框显示隐藏关联showDialog，当showDialog为true时显示弹框，为false时隐藏</li>
</ul>
</li>
<li>切换地址交互：点击某个地址会有高亮（额外样式），点击确认按钮会激活地址替换默认地址<ul>
<li>绑定点击事件的switchAddress方法，当点击某个地址时，将这个地址对象赋值给activeAddress激活地址。使用动态class，当当前地址的id和激活地址的id相等时，给这个地址添加激活样式active</li>
<li>点击确认时会将激活地址赋值给curAddress当前页面渲染的地址，然后将弹框关闭，激活地址置空</li>
</ul>
</li>
</ul>
<h4 id="提交订单"><a href="#提交订单" class="headerlink" title="提交订单"></a>提交订单</h4><p>调用接口方法，传递订单信息，然后携带orderId进行路由跳转</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; getCheckInfoAPI, createOrderAPI &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/apis&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; onMounted, ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; useRouter &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; useCartStore &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/stores&#x27;</span>;<br><span class="hljs-keyword">const</span> cartStore = <span class="hljs-title function_">useCartStore</span>()<br><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">useRouter</span>()<br><span class="hljs-keyword">const</span> checkInfo = <span class="hljs-title function_">ref</span>(&#123;&#125;); <span class="hljs-comment">// 订单对象</span><br><span class="hljs-keyword">const</span> curAddress = <span class="hljs-title function_">ref</span>(&#123;&#125;);<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getCheckInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getCheckInfoAPI</span>();<br>    checkInfo.<span class="hljs-property">value</span> = res.<span class="hljs-property">result</span>;<br>    curAddress.<span class="hljs-property">value</span> = checkInfo.<span class="hljs-property">value</span>.<span class="hljs-property">userAddresses</span>.<span class="hljs-title function_">find</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> item.<span class="hljs-property">isDefault</span> === <span class="hljs-number">0</span>);<br>&#125;;<br><span class="hljs-title function_">onMounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>    <span class="hljs-title function_">getCheckInfo</span>();<br>&#125;);<br><span class="hljs-keyword">const</span> showDialog = <span class="hljs-title function_">ref</span>(<span class="hljs-literal">false</span>);<br><br><span class="hljs-keyword">const</span> activeAddress = <span class="hljs-title function_">ref</span>(&#123;&#125;);<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">switchAddress</span> = item =&gt; &#123;<br>    activeAddress.<span class="hljs-property">value</span> = item;<br>&#125;;<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">confirmAddress</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    curAddress.<span class="hljs-property">value</span> = activeAddress.<span class="hljs-property">value</span>;<br>    showDialog.<span class="hljs-property">value</span> = <span class="hljs-literal">false</span>;<br>    activeAddress.<span class="hljs-property">value</span> = &#123;&#125;;<br>&#125;;<br><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">generateOrder</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">createOrderAPI</span>(&#123;<br>        <span class="hljs-attr">deliveryTimeType</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">payType</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">payChannel</span>: <span class="hljs-number">1</span>,<br>        <span class="hljs-attr">buyerMessage</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>        <span class="hljs-attr">goods</span>: checkInfo.<span class="hljs-property">value</span>.<span class="hljs-property">goods</span>.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> &#123;<br>            <span class="hljs-keyword">return</span> &#123;<br>                <span class="hljs-attr">skuId</span>: item.<span class="hljs-property">skuId</span>,<br>                <span class="hljs-attr">count</span>: item.<span class="hljs-property">count</span><br>            &#125;<br>        &#125;),<br>        <span class="hljs-attr">addressId</span>: curAddress.<span class="hljs-property">value</span>.<span class="hljs-property">id</span><br>    &#125;);<br>    <span class="hljs-keyword">const</span> orderId = res.<span class="hljs-property">result</span>.<span class="hljs-property">id</span><br>    router.<span class="hljs-title function_">push</span>(&#123;<br>        <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/pay&#x27;</span>,<br>        <span class="hljs-attr">query</span>: &#123;<br>            <span class="hljs-attr">id</span>: orderId<br>        &#125;<br>    &#125;)<br>    cartStore.<span class="hljs-title function_">getCart</span>()<br>&#125;;<br>&lt;/script&gt;<br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;xtx-pay-checkout-page&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;wrapper&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-comment">&lt;!-- 收货地址 --&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">h3</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box-title&quot;</span>&gt;</span>收货地址<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;box-body&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;address&quot;</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text&quot;</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;none&quot;</span> <span class="hljs-attr">v-if</span>=<span class="hljs-string">&quot;!curAddress&quot;</span>&gt;</span>您需要先添加收货地址才可提交订单。<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">ul</span> <span class="hljs-attr">v-else</span>&gt;</span></span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>收<span class="hljs-tag">&lt;<span class="hljs-name">i</span> /&gt;</span>货<span class="hljs-tag">&lt;<span class="hljs-name">i</span> /&gt;</span>人：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>&#123;&#123; curAddress.receiver &#125;&#125;                              						 <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>联系方式：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                                    &#123;&#123; curAddress.contact &#125;&#125;</span><br><span class="language-xml">                                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>收货地址：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                                    &#123;&#123; curAddress.fullLocation &#125;&#125; &#123;&#123; curAddress.address &#125;&#125;</span><br><span class="language-xml">                                <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;action&quot;</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;large&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showDialog = true&quot;</span>&gt;</span>切换地址<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="language-xml">                            <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;large&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;addFlag = true&quot;</span>&gt;</span>添加地址<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="language-xml">                ......</span><br><span class="language-xml">                <span class="hljs-comment">&lt;!-- 配送时间 --&gt;</span></span><br><span class="language-xml">                ......</span><br><span class="language-xml">                <span class="hljs-comment">&lt;!-- 支付方式 --&gt;</span></span><br><span class="language-xml">                ......</span><br><span class="language-xml">                <span class="hljs-comment">&lt;!-- 金额明细 --&gt;</span></span><br><span class="language-xml">                ......</span><br><span class="language-xml">                <span class="hljs-comment">&lt;!-- 提交订单 --&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;submit&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;large&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;generateOrder&quot;</span>&gt;</span>提交订单<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-comment">&lt;!-- 切换地址 --&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">el-dialog</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;showDialog&quot;</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;切换收货地址&quot;</span> <span class="hljs-attr">width</span>=<span class="hljs-string">&quot;30%&quot;</span> <span class="hljs-attr">center</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;addressWrapper&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;text item&quot;</span> <span class="hljs-attr">:class</span>=<span class="hljs-string">&quot;&#123; active: item.id === activeAddress.id &#125;&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;switchAddress(item)&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">                <span class="hljs-attr">v-for</span>=<span class="hljs-string">&quot;item in checkInfo.userAddresses&quot;</span> <span class="hljs-attr">:key</span>=<span class="hljs-string">&quot;item.id&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>收<span class="hljs-tag">&lt;<span class="hljs-name">i</span> /&gt;</span>货<span class="hljs-tag">&lt;<span class="hljs-name">i</span> /&gt;</span>人：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                        &#123;&#123; item.receiver &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>联系方式：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                        &#123;&#123; item.contact &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>收货地址：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                        &#123;&#123; item.fullLocation + item.address &#125;&#125;</span><br><span class="language-xml">                    <span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">footer</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;showDialog = false&quot;</span>&gt;</span>取消<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">el-button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span> @<span class="hljs-attr">click</span>=<span class="hljs-string">&quot;confirmAddress&quot;</span>&gt;</span>确定<span class="hljs-tag">&lt;/<span class="hljs-name">el-button</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">el-dialog</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">style</span> <span class="hljs-attr">scoped</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;scss&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="language-css"><span class="language-xml"><span class="hljs-selector-class">.text</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">min-height</span>: <span class="hljs-number">90px</span>;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">display</span>: flex;</span></span><br><span class="language-css"><span class="language-xml">    <span class="hljs-attribute">align-items</span>: center;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml">    &amp;<span class="hljs-selector-class">.item</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">border</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#f5f5f5</span>;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">margin-bottom</span>: <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">        <span class="hljs-attribute">cursor</span>: pointer;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml">        &amp;<span class="hljs-selector-class">.active</span>,</span></span><br><span class="language-css"><span class="language-xml">        &amp;<span class="hljs-selector-pseudo">:hover</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">border-color</span>: $xtxColor;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">background</span>: <span class="hljs-built_in">lighten</span>($xtxColor, <span class="hljs-number">50%</span>);</span></span><br><span class="language-css"><span class="language-xml">        &#125;</span></span><br><span class="language-css"><span class="language-xml"></span></span><br><span class="language-css"><span class="language-xml">        &gt;<span class="hljs-selector-tag">ul</span> &#123;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">padding</span>: <span class="hljs-number">10px</span>;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">font-size</span>: <span class="hljs-number">14px</span>;</span></span><br><span class="language-css"><span class="language-xml">            <span class="hljs-attribute">line-height</span>: <span class="hljs-number">30px</span>;</span></span><br><span class="language-css"><span class="language-xml">        &#125;</span></span><br><span class="language-css"><span class="language-xml">    &#125;</span></span><br><span class="language-css"><span class="language-xml">&#125;</span></span><br><span class="language-css"><span class="language-xml"></span><span class="hljs-tag">&lt;/<span class="hljs-name">style</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h3 id="支付模块"><a href="#支付模块" class="headerlink" title="支付模块"></a>支付模块</h3><h4 id="倒计时函数封装"><a href="#倒计时函数封装" class="headerlink" title="倒计时函数封装"></a>倒计时函数封装</h4><p>导入dayjs库，定义格式化后的时间formatTime和倒计时函数start，return出来在页面中使用</p>
<ul>
<li>倒计时函数start，传入currentTime，开启定时器，每隔一秒time.value–，在组件销毁onUnMounted阶段清除定时器</li>
<li>格式化后的时间formatTime定义为计算属性，调用dayjs.unix方法格式化为’mm分ss秒’。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// composables/useCountDown.js</span><br><span class="hljs-comment">// 封装倒计时逻辑函数</span><br><span class="hljs-keyword">import</span> dayjs <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;dayjs&quot;</span><br><span class="hljs-keyword">import</span> &#123; computed, onUnmounted, ref &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;vue&quot;</span><br><br><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useCountDown</span> = (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-comment">// 格式化时间 xx分xx秒</span><br>    <span class="hljs-keyword">let</span> timer = <span class="hljs-literal">null</span><br>    <span class="hljs-comment">// 1.响应式数据</span><br>    <span class="hljs-keyword">const</span> time = <span class="hljs-title function_">ref</span>(<span class="hljs-number">0</span>)<br>    <span class="hljs-keyword">const</span> formatTime = <span class="hljs-title function_">computed</span>(<span class="hljs-function">() =&gt;</span> dayjs.<span class="hljs-title function_">unix</span>(time.<span class="hljs-property">value</span>).<span class="hljs-title function_">format</span>(<span class="hljs-string">&#x27;mm分ss秒&#x27;</span>))<br>    <span class="hljs-comment">// 2.开启倒计时的函数</span><br>    <span class="hljs-keyword">const</span> <span class="hljs-title function_">start</span> = (<span class="hljs-params">currentTime</span>) =&gt; &#123;<br>        time.<span class="hljs-property">value</span> = currentTime<br>        timer = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>            time.<span class="hljs-property">value</span>--<br>        &#125;, <span class="hljs-number">1000</span>);<br>    &#125;<br>    <span class="hljs-comment">// 组件销毁时清除定时器</span><br>    <span class="hljs-title function_">onUnmounted</span>(<span class="hljs-function">() =&gt;</span> &#123;<br>        timer &amp;&amp; <span class="hljs-built_in">clearInterval</span>(timer)<br>    &#125;)<br>    <span class="hljs-keyword">return</span> &#123;<br>        formatTime,<br>        start<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>在页面中导入并调用useCountDown方法并进行解构赋值，拿到start方法和formatTime变量，获取到支付信息时，在返回的数据中有countdown属性，调用方法start(countdown)，然后在页面中直接使用formatTime</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs js">&lt;script setup&gt;<br><span class="hljs-keyword">import</span> &#123; getOrderAPI &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/apis&#x27;</span><br><span class="hljs-keyword">import</span> &#123; ref, onMounted &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; useRoute &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue-router&#x27;</span>;<br><span class="hljs-keyword">import</span> &#123; useCountDown &#125; <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@/composables/useCountDown&#x27;</span><br><span class="hljs-keyword">const</span> &#123; formatTime, start &#125; = <span class="hljs-title function_">useCountDown</span>()<br><span class="hljs-keyword">const</span> route = <span class="hljs-title function_">useRoute</span>()<br><span class="hljs-keyword">const</span> payInfo = <span class="hljs-title function_">ref</span>(&#123;&#125;)<br><span class="hljs-keyword">const</span> <span class="hljs-title function_">getPayInfo</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params"></span>) =&gt; &#123;<br>    <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> <span class="hljs-title function_">getOrderAPI</span>(route.<span class="hljs-property">query</span>.<span class="hljs-property">id</span>)<br>    payInfo.<span class="hljs-property">value</span> = res.<span class="hljs-property">result</span><br>    <span class="hljs-title function_">start</span>(res.<span class="hljs-property">result</span>.<span class="hljs-property">countdown</span>)<br>&#125;<br><span class="hljs-title function_">onMounted</span>(<span class="hljs-title function_">async</span> () =&gt; &#123;<br>    <span class="hljs-title function_">getPayInfo</span>()<br>&#125;)<br><span class="hljs-comment">// 跳转支付</span><br><span class="hljs-comment">// 支付地址</span><br><span class="hljs-keyword">const</span> baseURL = <span class="hljs-string">&#x27;http://pcapi-xiaotuxian-front-devtest.itheima.net/&#x27;</span><br><span class="hljs-keyword">const</span> backURL = <span class="hljs-string">&#x27;http://localhost:5173/paycallback&#x27;</span><br><span class="hljs-keyword">const</span> redirectUrl = <span class="hljs-built_in">encodeURIComponent</span>(backURL)<br><span class="hljs-keyword">const</span> payUrl = <span class="hljs-string">`<span class="hljs-subst">$&#123;baseURL&#125;</span>pay/aliPay?orderId=<span class="hljs-subst">$&#123;route.query.id&#125;</span>&amp;redirect=<span class="hljs-subst">$&#123;redirectUrl&#125;</span>`</span><br>&lt;/script&gt;<br><br><br><span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;xtx-pay-page&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;container&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-comment">&lt;!-- 付款信息 --&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pay-info&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">span</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;icon iconfont icon-queren2&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;tip&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>订单提交成功！请尽快完成支付。<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>支付还剩 <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#123;&#123; formatTime &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>, 超时后将取消订单<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;amount&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>应付总额：<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>¥&#123;&#123; payInfo.payMoney?.toFixed(2) &#125;&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-comment">&lt;!-- 付款方式 --&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;pay-type&quot;</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">p</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;head&quot;</span>&gt;</span>选择以下支付方式付款<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>支付平台<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn wx&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn alipay&quot;</span> <span class="hljs-attr">:href</span>=<span class="hljs-string">&quot;payUrl&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;item&quot;</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>支付方式<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span>&gt;</span>招商银行<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span>&gt;</span>工商银行<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span>&gt;</span>建设银行<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span>&gt;</span>农业银行<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                    <span class="hljs-tag">&lt;<span class="hljs-name">a</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;btn&quot;</span> <span class="hljs-attr">href</span>=<span class="hljs-string">&quot;javascript:;&quot;</span>&gt;</span>交通银行<span class="hljs-tag">&lt;/<span class="hljs-name">a</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span><br><span class="language-xml"><span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span></span><br></code></pre></td></tr></table></figure>

<h3 id="会员中心模块"><a href="#会员中心模块" class="headerlink" title="会员中心模块"></a>会员中心模块</h3><p>包括个人中心和我的订单，使用的是三级路由，为了一进来就加载个人中心页面，三级路由的oath设置为空</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> router = <span class="hljs-title function_">createRouter</span>(&#123;<br>  <span class="hljs-attr">history</span>: <span class="hljs-title function_">createWebHistory</span>(<span class="hljs-keyword">import</span>.<span class="hljs-property">meta</span>.<span class="hljs-property">env</span>.<span class="hljs-property">BASE_URL</span>),<br>  <span class="hljs-attr">routes</span>: [<br>  &#123;<br>      <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;/&#x27;</span>,<br>      <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Layout&#x27;</span>,<br>      <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/Layout/index.vue&#x27;</span>),<br>      <span class="hljs-attr">children</span>: [<br>        &#123;<br>          <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;member&#x27;</span>,<br>          <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Member&#x27;</span>,<br>          <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/Member/index.vue&#x27;</span>),<br>          <span class="hljs-attr">children</span>: [<br>            &#123;<br>              <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;&#x27;</span>,<br>              <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;UserInfo&#x27;</span>,<br>              <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/Member/Components/UserInfo.vue&#x27;</span>),<br>            &#125;,<br>            &#123;<br>              <span class="hljs-attr">path</span>: <span class="hljs-string">&#x27;order&#x27;</span>,<br>              <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;UserOrder&#x27;</span>,<br>              <span class="hljs-attr">component</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-keyword">import</span>(<span class="hljs-string">&#x27;@/views/Member/Components/UserOrder.vue&#x27;</span>),<br>            &#125;,<br>          ]<br>        &#125;,<br>      ]<br>    &#125;,<br>    <span class="hljs-title function_">scrollBehavior</span>(<span class="hljs-params"></span>) &#123;<br>    	<span class="hljs-keyword">return</span> &#123;<br>      	<span class="hljs-attr">top</span>: <span class="hljs-number">0</span><br>    	&#125;<br>  	&#125;<br>&#125;)<br></code></pre></td></tr></table></figure>

<h4 id="个人中心"><a href="#个人中心" class="headerlink" title="个人中心"></a>个人中心</h4><ul>
<li>直接从pinia中拿用户的信息渲染到页面上</li>
<li>猜你喜欢：调用接口获取喜欢列表数据，渲染到页面上</li>
</ul>
<h4 id="我的订单模块"><a href="#我的订单模块" class="headerlink" title="我的订单模块"></a>我的订单模块</h4><p><strong>分页功能</strong></p>
<p>使用elementPlus的分页组件el-pagination，page-size属性绑定调用获取订单列表接口时传递参数对象params的pageSize每页条数属性，page-sizes属性是可选的pageSize数组，total属性是调用获取订单列表接口返回的订单总数totalCount，size-change和current-change事件分别为每页条数和当前页码改变时触发的事件，后面跟方法。当每页条数和当前页码改变时传递新的pageSize和page，赋值给params，然后调用获取订单列表接口方法重新获取订单列表数据。</p>
<p><strong>tab栏切换</strong></p>
<p>点击tab栏时，会触发el-tabs组件的tab-change事件，执行对应的事件方法，传递的值是订单状态orderState，然后重新获取订单列表数据。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup&gt;<br>import &#123; getOrderListAPI &#125; from &#x27;@/apis&#x27;;<br>import &#123; ref, onMounted &#125; from &#x27;vue&#x27;;<br>import OrderItem from &#x27;./OrderItem.vue&#x27;<br>// tab列表<br>const tabTypes = [<br>    &#123; name: &quot;all&quot;, label: &quot;全部订单&quot; &#125;,<br>    &#123; name: &quot;unpay&quot;, label: &quot;待付款&quot; &#125;,<br>    &#123; name: &quot;deliver&quot;, label: &quot;待发货&quot; &#125;,<br>    &#123; name: &quot;receive&quot;, label: &quot;待收货&quot; &#125;,<br>    &#123; name: &quot;comment&quot;, label: &quot;待评价&quot; &#125;,<br>    &#123; name: &quot;complete&quot;, label: &quot;已完成&quot; &#125;,<br>    &#123; name: &quot;cancel&quot;, label: &quot;已取消&quot; &#125;<br>]<br>// 订单列表<br>const orderList = ref([])<br>const totalCount = ref(0)<br>const params = ref(&#123;<br>    page: 1,<br>    pageSize: 2,<br>    orderState: 0<br>&#125;)<br>const getOrderList = async () =&gt; &#123;<br>    const res = await getOrderListAPI(params.value)<br>    orderList.value = res.result<br>    totalCount.value = res.result.counts<br>&#125;<br>onMounted(() =&gt; &#123;<br>    getOrderList()<br>&#125;)<br>const tabChange = (type) =&gt; &#123;<br>    params.value.orderState = type<br>    getOrderList()<br>&#125;<br>const handleSizeChange = (pageSize) =&gt; &#123;<br>    params.value.pageSize = pageSize<br>    getOrderList()<br>&#125;<br>const handleCurrentChange = (page) =&gt; &#123;<br>    params.value.page = page<br>    getOrderList()<br>&#125;<br>&lt;/script&gt;<br>&lt;template&gt;<br>    &lt;div class=&quot;order-container&quot;&gt;<br>        &lt;el-tabs @tab-change=&quot;tabChange&quot;&gt;<br>            &lt;!-- tab切换 --&gt;<br>            &lt;el-tab-pane v-for=&quot;item in tabTypes&quot; :key=&quot;item.name&quot; :label=&quot;item.label&quot; /&gt;<br>            &lt;div class=&quot;main-container&quot;&gt;<br>                &lt;div class=&quot;holder-container&quot; v-if=&quot;orderList.length === 0&quot;&gt;<br>                    &lt;el-empty description=&quot;暂无订单数据&quot; /&gt;<br>                &lt;/div&gt;<br>                &lt;div v-else&gt;<br>                    &lt;!-- 订单列表 --&gt;<br>                    &lt;div class=&quot;order-item&quot; v-for=&quot;order in orderList.items&quot; :key=&quot;order.id&quot;&gt;<br>                        &lt;OrderItem :order=&quot;order&quot;&gt;&lt;/OrderItem&gt;                        <br>                    &lt;/div&gt;<br>                    &lt;!-- 分页 --&gt;<br>                    &lt;div class=&quot;pagination-container&quot;&gt;<br>                        &lt;el-pagination :page-size=&quot;params.pageSize&quot; :page-sizes=&quot;[2, 5, 10, 20]&quot; small           layout=&quot;sizes, prev, pager, next&quot; :total=&quot;totalCount&quot; background @size-change=&quot;handleSizeChange&quot;<br>                            @current-change=&quot;handleCurrentChange&quot; /&gt;<br>                    &lt;/div&gt;<br>                &lt;/div&gt;<br>            &lt;/div&gt;<br><br>        &lt;/el-tabs&gt;<br>    &lt;/div&gt;<br>&lt;/template&gt;<br></code></pre></td></tr></table></figure>

<p>封装每个订单项的orderItem组件，将orderList订单列表中的每一项传值给orderItem进行数据渲染。</p>
<p><strong>倒计时</strong>：</p>
<p>导入封装的倒计时函数在组件挂载onMounted后进行调用，传进去的是每个订单order中的countdown</p>
<p><strong>订单状态</strong>：</p>
<p>默认渲染出来的是数字，想要显示对应的订单状态，定义formatPayState方法，定义数字和订单状态映射关系的stateMap对象，<code>return stateMap[payState]</code>，然后在页面中使用formatPayState方法。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs vue">&lt;script setup&gt;<br>import &#123; onMounted &#125; from &#x27;vue&#x27;<br>import &#123; useCountDown &#125; from &#x27;@/composables/useCountDown&#x27;;<br><br>const props = defineProps(&#123;<br>    order: &#123;<br>        type: Object,<br>        default: () =&gt; (&#123;&#125;)<br>    &#125;<br>&#125;)<br>const &#123; formatTime, start &#125; = useCountDown()<br>onMounted(() =&gt; &#123;<br>    start(props.order.countdown)<br>&#125;)<br>const formatPayState = (payState) =&gt; &#123;<br>    const stateMap = &#123;<br>        1: &#x27;待付款&#x27;,<br>        2: &#x27;待发货&#x27;,<br>        3: &#x27;待收货&#x27;,<br>        4: &#x27;待评价&#x27;,<br>        5: &#x27;已完成&#x27;,<br>        6: &#x27;已取消&#x27;,<br>    &#125;<br>    return stateMap[payState]<br>&#125;<br>&lt;/script&gt;<br>&lt;template&gt;<br>    &lt;div class=&quot;head&quot;&gt;<br>        &lt;span&gt;下单时间：&#123;&#123; order.createTime &#125;&#125;&lt;/span&gt;<br>        &lt;span&gt;订单编号：&#123;&#123; order.id &#125;&#125;&lt;/span&gt;<br>        &lt;!-- 未付款，倒计时时间还有 --&gt;<br>        &lt;span class=&quot;down-time&quot; v-if=&quot;order.orderState === 1&quot;&gt;<br>            &lt;i class=&quot;iconfont icon-down-time&quot;&gt;&lt;/i&gt;<br>            &lt;b&gt;付款截止: &#123;&#123; formatTime &#125;&#125;&lt;/b&gt;<br>        &lt;/span&gt;<br>    &lt;/div&gt;<br>    &lt;div class=&quot;body&quot;&gt;<br>        &lt;div class=&quot;column goods&quot;&gt;<br>			......<br>        &lt;/div&gt;<br>        &lt;div class=&quot;column state&quot;&gt;<br>            &lt;p&gt;&#123;&#123; formatPayState(order.orderState) &#125;&#125;&lt;/p&gt;<br>            &lt;p v-if=&quot;order.orderState === 3&quot;&gt;<br>                &lt;a href=&quot;javascript:;&quot; class=&quot;green&quot;&gt;查看物流&lt;/a&gt;<br>            &lt;/p&gt;<br>            &lt;p v-if=&quot;order.orderState === 4&quot;&gt;<br>                &lt;a href=&quot;javascript:;&quot; class=&quot;green&quot;&gt;评价商品&lt;/a&gt;<br>            &lt;/p&gt;<br>            &lt;p v-if=&quot;order.orderState === 5&quot;&gt;<br>                &lt;a href=&quot;javascript:;&quot; class=&quot;green&quot;&gt;查看评价&lt;/a&gt;<br>            &lt;/p&gt;<br>        &lt;/div&gt;<br>		......<br>    &lt;/div&gt;<br>&lt;/template&gt;<br>&lt;style  scoped lang=&quot;scss&quot;&gt;<br></code></pre></td></tr></table></figure>
































































































































































































































		</div>

		
		<div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
			<div class="article-copyright-info-container">
    <ul>
        <li><strong>Title:</strong> Vue3学习</li>
        <li><strong>Author:</strong> chengj-code</li>
        <li><strong>Created at
                :</strong> 2023-05-13 15:30:42</li>
        
            <li>
                <strong>Updated at
                    :</strong> 2023-06-02 10:59:08
            </li>
        
        <li>
            <strong>Link:</strong> https://chengj-code.github.io/2023/05/13/Vue3学习/
        </li>
        <li>
            <strong>
                License:
            </strong>
            

            
                This work is licensed under <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a>.
            
        </li>
    </ul>
</div>

		</div>
		

		

		

		
		<div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
			
			<div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
				<a class="prev" rel="prev" href="/2023/05/23/%E5%89%8D%E7%AB%AF%E9%9D%A2%E8%AF%95%E5%85%AB%E8%82%A1%E6%96%87%E6%95%B4%E7%90%86/">
					<span class="left arrow-icon flex justify-center items-center">
						<i class="fa-solid fa-chevron-left"></i>
					</span>
					<span class="title flex justify-center items-center">
						<span class="post-nav-title-item">前端面试八股文整理</span>
						<span class="post-nav-item">Prev posts</span>
					</span>
				</a>
			</div>
			
			
		</div>
		


		
	</div>

	
	<div class="toc-content-container">
		<div class="post-toc-wrap">
	<div class="post-toc">
		<div class="toc-title">On this page</div>
		<div class="page-title">Vue3学习</div>
		<ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%AE%89%E8%A3%85%E5%90%AF%E5%8A%A8"><span class="nav-number">1.</span> <span class="nav-text">项目安装启动</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%91%BD%E4%BB%A4%E9%85%8D%E7%BD%AE%E6%B7%98%E5%AE%9D%E9%95%9C%E5%83%8F"><span class="nav-number">1.1.</span> <span class="nav-text">通过命令配置淘宝镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%87%E6%8D%A2%E5%9B%9E%E5%8E%9F%E9%95%9C%E5%83%8F"><span class="nav-number">1.2.</span> <span class="nav-text">切换回原镜像</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue3%E9%A1%B9%E7%9B%AE%E5%88%9B%E5%BB%BA"><span class="nav-number">1.3.</span> <span class="nav-text">Vue3项目创建</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E5%BC%8FAPI"><span class="nav-number">2.</span> <span class="nav-text">组合式API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#setup%E9%80%89%E9%A1%B9"><span class="nav-number">2.1.</span> <span class="nav-text">setup选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E5%BC%8FAPI-1"><span class="nav-number">2.2.</span> <span class="nav-text">组合式API</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#reactive%E5%92%8Cref%E5%87%BD%E6%95%B0"><span class="nav-number">2.3.</span> <span class="nav-text">reactive和ref函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E5%B1%9E%E6%80%A7computed"><span class="nav-number">2.4.</span> <span class="nav-text">计算属性computed</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#wacth%E5%87%BD%E6%95%B0"><span class="nav-number">2.5.</span> <span class="nav-text">wacth函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Vue3%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="nav-number">2.6.</span> <span class="nav-text">Vue3生命周期函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%88%B6%E5%AD%90%E9%80%9A%E4%BF%A1"><span class="nav-number">2.7.</span> <span class="nav-text">父子通信</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%88%B6%E4%BC%A0%E5%AD%90"><span class="nav-number">2.7.1.</span> <span class="nav-text">父传子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%90%E4%BC%A0%E7%88%B6"><span class="nav-number">2.7.2.</span> <span class="nav-text">子传父</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A8%A1%E6%9D%BF%E5%BC%95%E7%94%A8"><span class="nav-number">2.8.</span> <span class="nav-text">模板引用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#provide%E5%92%8Creject"><span class="nav-number">2.9.</span> <span class="nav-text">provide和reject</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Typescript"><span class="nav-number">3.</span> <span class="nav-text">Typescript</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E7%AE%80%E4%BB%8B"><span class="nav-number">3.1.</span> <span class="nav-text">TS简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3"><span class="nav-number">3.2.</span> <span class="nav-text">类型注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%8E%A8%E8%AE%BA"><span class="nav-number">3.3.</span> <span class="nav-text">类型推论</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E6%95%B0%E7%BB%84"><span class="nav-number">3.4.</span> <span class="nav-text">定义数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E8%81%94%E5%90%88%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.5.</span> <span class="nav-text">定义联合类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%88%AB%E5%90%8D"><span class="nav-number">3.6.</span> <span class="nav-text">类型别名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="nav-number">3.7.</span> <span class="nav-text">定义函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E6%9E%9C%E5%87%BD%E6%95%B0%E6%B2%A1%E6%9C%89%E8%BF%94%E5%9B%9E%E5%80%BC%EF%BC%8C%E5%B0%B1%E8%AE%BE%E7%BD%AE%E4%B8%BAvoid%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.7.1.</span> <span class="nav-text">如果函数没有返回值，就设置为void类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="nav-number">3.7.2.</span> <span class="nav-text">可选参数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AF%B9%E8%B1%A1"><span class="nav-number">3.8.</span> <span class="nav-text">定义的对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E7%B1%BB%E5%9E%8Binterface"><span class="nav-number">3.9.</span> <span class="nav-text">接口类型interface</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#interface%E5%92%8Ctype%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">3.9.1.</span> <span class="nav-text">interface和type的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E7%BB%A7%E6%89%BF"><span class="nav-number">3.9.2.</span> <span class="nav-text">接口继承</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%83%E7%BB%84%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.10.</span> <span class="nav-text">元组类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E9%9D%A2%E9%87%8F%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.11.</span> <span class="nav-text">字面量类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%9A%E4%B8%BE%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.12.</span> <span class="nav-text">枚举类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#any%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.13.</span> <span class="nav-text">any类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E6%96%AD%E8%A8%80"><span class="nav-number">3.14.</span> <span class="nav-text">类型断言</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Typescript%E8%BF%9B%E9%98%B6"><span class="nav-number">4.</span> <span class="nav-text">Typescript进阶</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%9B%E5%9E%8B"><span class="nav-number">4.1.</span> <span class="nav-text">泛型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%9B%E5%9E%8B%E7%BA%A6%E6%9D%9F"><span class="nav-number">4.2.</span> <span class="nav-text">泛型约束</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%9B%E5%9E%8B%E6%8E%A5%E5%8F%A3"><span class="nav-number">4.3.</span> <span class="nav-text">泛型接口</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vite%E5%88%9B%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="nav-number">5.</span> <span class="nav-text">Vite创建项目</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E4%B8%8Bprops%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">5.1.</span> <span class="nav-text">TS下props的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E4%B8%8Bemits%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">5.2.</span> <span class="nav-text">TS下emits的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E4%B8%8Bref%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">5.3.</span> <span class="nav-text">TS下ref的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E4%B8%8Bcomputed%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">5.4.</span> <span class="nav-text">TS下computed的使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E4%B8%8B%E7%9A%84%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">5.5.</span> <span class="nav-text">TS下的事件处理函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TS%E4%B8%8B%E7%9A%84%E9%80%9A%E8%BF%87ref%E8%8E%B7%E5%8F%96dom"><span class="nav-number">5.6.</span> <span class="nav-text">TS下的通过ref获取dom</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%AF%E9%80%89%E9%93%BE%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="nav-number">5.6.1.</span> <span class="nav-text">可选链操作符?</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Typescript%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E%E6%96%87%E4%BB%B6"><span class="nav-number">5.7.</span> <span class="nav-text">Typescript类型声明文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pinia"><span class="nav-number">6.</span> <span class="nav-text">Pinia</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#pinia%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="nav-number">6.1.</span> <span class="nav-text">pinia的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%BC%80%E5%A7%8B"><span class="nav-number">7.</span> <span class="nav-text">项目开始</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B9%E7%9B%AE%E5%88%AB%E5%90%8D%E8%B7%AF%E5%BE%84%E8%81%94%E6%83%B3%E8%AE%BE%E7%BD%AE"><span class="nav-number">7.1.</span> <span class="nav-text">项目别名路径联想设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E5%88%B6elementPlus%E4%B8%BB%E9%A2%98"><span class="nav-number">7.2.</span> <span class="nav-text">定制elementPlus主题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#axios%E5%B0%81%E8%A3%85"><span class="nav-number">7.3.</span> <span class="nav-text">axios封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scss%E6%96%87%E4%BB%B6%E8%87%AA%E5%8A%A8%E5%AF%BC%E5%85%A5"><span class="nav-number">7.4.</span> <span class="nav-text">scss文件自动导入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BA%AF%E5%B1%95%E7%A4%BA%E7%B1%BB%E7%BB%84%E4%BB%B6%E8%B0%83%E7%94%A8%E5%B0%81%E8%A3%85%E6%80%9D%E8%B7%AF"><span class="nav-number">7.5.</span> <span class="nav-text">纯展示类组件调用封装思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E9%80%BB%E8%BE%91%E5%87%BD%E6%95%B0%E6%8B%86%E5%88%86%E4%B8%9A%E5%8A%A1"><span class="nav-number">7.6.</span> <span class="nav-text">使用逻辑函数拆分业务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A0%E9%99%90%E6%BB%9A%E5%8A%A8%E5%AE%9E%E7%8E%B0"><span class="nav-number">7.7.</span> <span class="nav-text">无限滚动实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BA%A7%E5%88%86%E7%B1%BB-%E5%AE%9A%E5%88%B6%E8%B7%AF%E7%94%B1%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BA"><span class="nav-number">7.8.</span> <span class="nav-text">二级分类-定制路由滚动行为</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%81%E8%A3%85%E5%A4%8D%E6%9D%82%E7%BB%84%E4%BB%B6"><span class="nav-number">7.9.</span> <span class="nav-text">封装复杂组件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E7%94%A8%E6%80%9D%E8%B7%AF"><span class="nav-number">7.9.1.</span> <span class="nav-text">通用思路</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E9%A2%84%E8%A7%88%E7%BB%84%E4%BB%B6%E7%9A%84%E5%B0%81%E8%A3%85%E9%80%BB%E8%BE%91"><span class="nav-number">7.9.2.</span> <span class="nav-text">图片预览组件的封装逻辑</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SKU%E7%BB%84%E4%BB%B6"><span class="nav-number">7.10.</span> <span class="nav-text">SKU组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B1%E7%94%A8%E7%BB%84%E4%BB%B6%E5%85%A8%E5%B1%80%E6%B3%A8%E5%86%8C"><span class="nav-number">7.11.</span> <span class="nav-text">共用组件全局注册</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E8%A1%A8%E5%8D%95%E6%A0%A1%E9%AA%8C"><span class="nav-number">7.12.</span> <span class="nav-text">登录表单校验</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E5%B1%80%E6%A0%A1%E9%AA%8C"><span class="nav-number">7.12.1.</span> <span class="nav-text">全局校验</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pinia%E7%AE%A1%E7%90%86%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE"><span class="nav-number">7.12.2.</span> <span class="nav-text">pinia管理用户数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pinia%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E5%AD%98%E5%82%A8"><span class="nav-number">7.13.</span> <span class="nav-text">pinia数据持久化存储</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">7.14.</span> <span class="nav-text">购物车</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E9%93%BA%E8%AE%BE"><span class="nav-number">7.14.1.</span> <span class="nav-text">页面铺设</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%88%97%E8%A1%A8%E9%A1%B5%E9%9D%A2"><span class="nav-number">7.14.2.</span> <span class="nav-text">购物车列表页面</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E9%80%89%E6%A1%86%E5%8A%9F%E8%83%BD"><span class="nav-number">7.14.3.</span> <span class="nav-text">单选框功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A8%E9%80%89%E6%A1%86%E5%8A%9F%E8%83%BD"><span class="nav-number">7.14.4.</span> <span class="nav-text">全选框功能</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8B%BE%E9%80%89%E5%95%86%E5%93%81%E6%80%BB%E6%95%B0%E9%87%8F-%E5%8B%BE%E9%80%89%E5%95%86%E5%93%81%E6%80%BB%E4%BB%B7"><span class="nav-number">7.14.5.</span> <span class="nav-text">勾选商品总数量&#x2F;勾选商品总价</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%80%E6%96%B0%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">7.14.6.</span> <span class="nav-text">获取最新购物车</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">7.14.7.</span> <span class="nav-text">添加购物车</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">7.14.8.</span> <span class="nav-text">删除购物车</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%88%E5%B9%B6%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">7.14.9.</span> <span class="nav-text">合并购物车</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%93%E7%AE%97%E6%A8%A1%E5%9D%97"><span class="nav-number">7.15.</span> <span class="nav-text">结算模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E6%B8%B2%E6%9F%93"><span class="nav-number">7.15.1.</span> <span class="nav-text">地址渲染</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E8%AE%A2%E5%8D%95"><span class="nav-number">7.15.2.</span> <span class="nav-text">提交订单</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%AF%E4%BB%98%E6%A8%A1%E5%9D%97"><span class="nav-number">7.16.</span> <span class="nav-text">支付模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%80%92%E8%AE%A1%E6%97%B6%E5%87%BD%E6%95%B0%E5%B0%81%E8%A3%85"><span class="nav-number">7.16.1.</span> <span class="nav-text">倒计时函数封装</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BC%9A%E5%91%98%E4%B8%AD%E5%BF%83%E6%A8%A1%E5%9D%97"><span class="nav-number">7.17.</span> <span class="nav-text">会员中心模块</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AA%E4%BA%BA%E4%B8%AD%E5%BF%83"><span class="nav-number">7.17.1.</span> <span class="nav-text">个人中心</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%88%91%E7%9A%84%E8%AE%A2%E5%8D%95%E6%A8%A1%E5%9D%97"><span class="nav-number">7.17.2.</span> <span class="nav-text">我的订单模块</span></a></li></ol></li></ol></li></ol>

	</div>
</div>
	</div>
	
</div>
			</div>

			
		</div>

		<div class="main-content-footer">
			<footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2022</span>
              -
            
            2025&nbsp;&nbsp;<i class="fa-solid fa-heart fa-beat" style="--fa-animation-duration: 0.5s; color: #f54545"></i>&nbsp;&nbsp;<a href="/">chengj-code</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        6 posts in total
                    </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">VISITOR COUNT</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">TOTAL PAGE VIEWS</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">POWERED BY <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a></span>
            <span class="text-sm lg:block">THEME&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.8.2</a></span>
        </div>
        
        
            <div>
                Blog up for <span class="odometer" id="runtime_days" ></span> days <span class="odometer" id="runtime_hours"></span> hrs <span class="odometer" id="runtime_minutes"></span> Min <span class="odometer" id="runtime_seconds"></span> Sec
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
		</div>
	</div>

	
	<div class="post-tools">
		<div class="post-tools-container">
	<ul class="article-tools-list">
		<!-- TOC aside toggle -->
		
		<li class="right-bottom-tools page-aside-toggle">
			<i class="fa-regular fa-outdent"></i>
		</li>
		

		<!-- go comment -->
		
	</ul>
</div>
	</div>
	

	<div class="right-side-tools-container">
		<div class="side-tools-container">
	<ul class="hidden-tools-list">
		<li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-plus"></i>
		</li>

		<li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
			<i class="fa-regular fa-magnifying-glass-minus"></i>
		</li>

		<li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
			<i class="fa-regular fa-moon"></i>
		</li>

		<!-- rss -->
		

		

		<li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
			<i class="fa-regular fa-arrow-down"></i>
		</li>
	</ul>

	<ul class="visible-tools-list">
		<li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
			<i class="fa-regular fa-cog fa-spin"></i>
		</li>
		
		<li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
			<i class="arrow-up fas fa-arrow-up"></i>
			<span class="percent"></span>
		</li>
		
		
	</ul>
</div>
	</div>

	<div class="image-viewer-container">
	<img src="">
</div>

	

</main>



<script src="/js/build/libs/Swup.min.js"></script>

<script src="/js/build/libs/SwupSlideTheme.min.js"></script>

<script src="/js/build/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/build/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/build/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/build/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>




	
<script src="/js/build/tools/imageViewer.js" type="module"></script>

<script src="/js/build/utils.js" type="module"></script>

<script src="/js/build/main.js" type="module"></script>

<script src="/js/build/layouts/navbarShrink.js" type="module"></script>

<script src="/js/build/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/build/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/build/layouts/categoryList.js" type="module"></script>





    
<script src="/js/build/tools/codeBlock.js" type="module"></script>




    
<script src="/js/build/layouts/lazyload.js" type="module"></script>




    
<script src="/js/build/tools/runtime.js"></script>

    
<script src="/js/build/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/build/libs/Typed.min.js"></script>

  
<script src="/js/build/plugins/typed.js" type="module"></script>








    
<script src="/js/build/libs/anime.min.js"></script>





    
<script src="/js/build/tools/tocToggle.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/layouts/toc.js" type="module" data-swup-reload-script=""></script>

<script src="/js/build/plugins/tabs.js" type="module" data-swup-reload-script=""></script>




<script src="/js/build/libs/moment-with-locales.min.js" data-swup-reload-script=""></script>


<script src="/js/build/layouts/essays.js" type="module" data-swup-reload-script=""></script>





	
</body>

</html>